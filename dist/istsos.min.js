/*
 The buffer module from node.js, for the browser.

 @author   Feross Aboukhadijeh <feross@feross.org> <http://feross.org>
 @license  MIT
*/
var $jscomp={scope:{}};$jscomp.defineProperty="function"==typeof Object.defineProperties?Object.defineProperty:function(e,t,r){if(r.get||r.set)throw new TypeError("ES3 does not support getters and setters.");e!=Array.prototype&&e!=Object.prototype&&(e[t]=r.value)},$jscomp.getGlobal=function(e){return"undefined"!=typeof window&&window===e?e:"undefined"!=typeof global&&null!=global?global:e},$jscomp.global=$jscomp.getGlobal(this),$jscomp.SYMBOL_PREFIX="jscomp_symbol_",$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){},$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)},$jscomp.symbolCounter_=0,$jscomp.Symbol=function(e){return $jscomp.SYMBOL_PREFIX+(e||"")+$jscomp.symbolCounter_++},$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var e=$jscomp.global.Symbol.iterator;e||(e=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("iterator")),"function"!=typeof Array.prototype[e]&&$jscomp.defineProperty(Array.prototype,e,{configurable:!0,writable:!0,value:function(){return $jscomp.arrayIterator(this)}}),$jscomp.initSymbolIterator=function(){}},$jscomp.arrayIterator=function(e){var t=0;return $jscomp.iteratorPrototype(function(){return t<e.length?{done:!1,value:e[t++]}:{done:!0}})},$jscomp.iteratorPrototype=function(e){return $jscomp.initSymbolIterator(),e={next:e},e[$jscomp.global.Symbol.iterator]=function(){return this},e},$jscomp.makeIterator=function(e){$jscomp.initSymbolIterator();var t=e[Symbol.iterator];return t?t.call(e):$jscomp.arrayIterator(e)},$jscomp.polyfill=function(e,t,r,i){if(t){for(r=$jscomp.global,e=e.split("."),i=0;i<e.length-1;i++){var n=e[i];n in r||(r[n]={}),r=r[n]}e=e[e.length-1],i=r[e],t=t(i),t!=i&&null!=t&&$jscomp.defineProperty(r,e,{configurable:!0,writable:!0,value:t})}},$jscomp.EXPOSE_ASYNC_EXECUTOR=!0,$jscomp.FORCE_POLYFILL_PROMISE=!1,$jscomp.polyfill("Promise",function(e){function t(){this.batch_=null}if(e&&!$jscomp.FORCE_POLYFILL_PROMISE)return e;t.prototype.asyncExecute=function(e){return null==this.batch_&&(this.batch_=[],this.asyncExecuteBatch_()),this.batch_.push(e),this},t.prototype.asyncExecuteBatch_=function(){var e=this;this.asyncExecuteFunction(function(){e.executeBatch_()})};var r=$jscomp.global.setTimeout;t.prototype.asyncExecuteFunction=function(e){r(e,0)},t.prototype.executeBatch_=function(){for(;this.batch_&&this.batch_.length;){var e=this.batch_;this.batch_=[];for(var t=0;t<e.length;++t){var r=e[t];delete e[t];try{r()}catch(e){this.asyncThrow_(e)}}}this.batch_=null},t.prototype.asyncThrow_=function(e){this.asyncExecuteFunction(function(){throw e})};var i=function(e){this.state_=0,this.result_=void 0,this.onSettledCallbacks_=[];var t=this.createResolveAndReject_();try{e(t.resolve,t.reject)}catch(e){t.reject(e)}};i.prototype.createResolveAndReject_=function(){function e(e){return function(i){r||(r=!0,e.call(t,i))}}var t=this,r=!1;return{resolve:e(this.resolveTo_),reject:e(this.reject_)}},i.prototype.resolveTo_=function(e){if(e===this)this.reject_(new TypeError("A Promise cannot resolve to itself"));else if(e instanceof i)this.settleSameAsPromise_(e);else{var t;e:switch(typeof e){case"object":t=null!=e;break e;case"function":t=!0;break e;default:t=!1}t?this.resolveToNonPromiseObj_(e):this.fulfill_(e)}},i.prototype.resolveToNonPromiseObj_=function(e){var t=void 0;try{t=e.then}catch(e){return void this.reject_(e)}"function"==typeof t?this.settleSameAsThenable_(t,e):this.fulfill_(e)},i.prototype.reject_=function(e){this.settle_(2,e)},i.prototype.fulfill_=function(e){this.settle_(1,e)},i.prototype.settle_=function(e,t){if(0!=this.state_)throw Error("Cannot settle("+e+", "+t|"): Promise already settled in state"+this.state_);this.state_=e,this.result_=t,this.executeOnSettledCallbacks_()},i.prototype.executeOnSettledCallbacks_=function(){if(null!=this.onSettledCallbacks_){for(var e=this.onSettledCallbacks_,t=0;t<e.length;++t)e[t].call(),e[t]=null;this.onSettledCallbacks_=null}};var n=new t;return i.prototype.settleSameAsPromise_=function(e){var t=this.createResolveAndReject_();e.callWhenSettled_(t.resolve,t.reject)},i.prototype.settleSameAsThenable_=function(e,t){var r=this.createResolveAndReject_();try{e.call(t,r.resolve,r.reject)}catch(e){r.reject(e)}},i.prototype.then=function(e,t){function r(e,t){return"function"==typeof e?function(t){try{n(e(t))}catch(e){o(e)}}:t}var n,o,s=new i(function(e,t){n=e,o=t});return this.callWhenSettled_(r(e,n),r(t,o)),s},i.prototype.catch=function(e){return this.then(void 0,e)},i.prototype.callWhenSettled_=function(e,t){function r(){switch(i.state_){case 1:e(i.result_);break;case 2:t(i.result_);break;default:throw Error("Unexpected state: "+i.state_)}}var i=this;null==this.onSettledCallbacks_?n.asyncExecute(r):this.onSettledCallbacks_.push(function(){n.asyncExecute(r)})},i.resolve=function(e){return e instanceof i?e:new i(function(t,r){t(e)})},i.reject=function(e){return new i(function(t,r){r(e)})},i.race=function(e){return new i(function(t,r){for(var n=$jscomp.makeIterator(e),o=n.next();!o.done;o=n.next())i.resolve(o.value).callWhenSettled_(t,r)})},i.all=function(e){var t=$jscomp.makeIterator(e),r=t.next();return r.done?i.resolve([]):new i(function(e,n){var o=[],s=0;do{o.push(void 0),s++,i.resolve(r.value).callWhenSettled_(function(t){return function(r){o[t]=r,0==--s&&e(o)}}(o.length-1),n),r=t.next()}while(!r.done)})},$jscomp.EXPOSE_ASYNC_EXECUTOR&&(i.$jscomp$new$AsyncExecutor=function(){return new t}),i},"es6-impl","es3"),$jscomp.array=$jscomp.array||{},$jscomp.iteratorFromArray=function(e,t){$jscomp.initSymbolIterator(),e instanceof String&&(e+="");var r=0,i={next:function(){if(r<e.length){var n=r++;return{value:t(n,e[n]),done:!1}}return i.next=function(){return{done:!0,value:void 0}},i.next()}};return i[Symbol.iterator]=function(){return i},i},$jscomp.polyfill("Array.prototype.keys",function(e){return e||function(){return $jscomp.iteratorFromArray(this,function(e){return e})}},"es6-impl","es3"),$jscomp.polyfill("Array.prototype.values",function(e){return e||function(){return $jscomp.iteratorFromArray(this,function(e,t){return t})}},"es6","es3"),$jscomp.polyfill("Array.prototype.fill",function(e){return e||function(e,t,r){var i=this.length||0;for(0>t&&(t=Math.max(0,i+t)),(null==r||r>i)&&(r=i),r=Number(r),0>r&&(r=Math.max(0,i+r)),t=Number(t||0);t<r;t++)this[t]=e;return this}},"es6-impl","es3"),function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.istsos=t():e.istsos=t()}(this,function(){return function(e){function t(i){if(r[i])return r[i].exports;var n=r[i]={i:i,l:!1,exports:{}};return e[i].call(n.exports,n,n.exports,t),n.l=!0,n.exports}var r={};return t.m=e,t.c=r,t.i=function(e){return e},t.d=function(e,r,i){t.o(e,r)||Object.defineProperty(e,r,{configurable:!1,enumerable:!0,get:i})},t.n=function(e){var r=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(r,"a",r),r},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=18)}([function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var i=t.HttpAPI={_request:function(e){return new Promise(function(t,r){var i=new XMLHttpRequest;i.open(e.method||"GET",e.url),e.headers&&Object.keys(e.headers).forEach(function(t){i.setRequestHeader(t,e.headers[t])}),i.onload=function(){200<=i.status&&300>i.status?JSON.parse(i.response).success?t(JSON.parse(i.response)):r(JSON.parse(i.response).message):r(i.statusText)},i.onerror=function(){return r(i.statusText)},i.send(e.data)})},get:function(e,t){var r={method:"GET"};r.url=e;for(var n in t)r[n]=t[n];return i._request(r)},put:function(e,t){var r={method:"PUT"};r.url=e;for(var n in t)r[n]=t[n];return i._request(r)},post:function(e,t){var r={method:"POST"};r.url=e;for(var n in t)r[n]=t[n];return i._request(r)},delete:function(e,t){var r={method:"DELETE"};r.url=e;for(var n in t)r[n]=t[n];return i._request(r)}}},function(t,r,i){Object.defineProperty(r,"__esModule",{value:!0}),r.EventEmitter=void 0;var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,r,i){return r&&e(t.prototype,r),i&&e(t,i),t}}(),o=i(6);r.EventEmitter=function(){function t(){if(!(this instanceof t))throw new TypeError("Cannot call a class as a function");this.events={}}return n(t,[{key:"on",value:function(e,t){if(!o.EventTypes.hasOwnProperty(e))throw"EVENT TYPE NOT RECOGNIZED!!!";return(this.events[e]=this.events[e]||[]).push(t),this}},{key:"once",value:function(e,t){function r(){this.off(e,r),t.apply(this,arguments)}return r.callback=t,this.on(e,r),this}},{key:"off",value:function(e,t){return this.events[e]&&this._removeHandler(e,t),this}},{key:"fire",value:function(e,t){this.events[e]=this.events[e]||[];for(var r=0;r<this.events[e].length;r++)this.events[e][r].apply(this,[t])}},{key:"_removeHandler",value:function(e,t){this.events[e]=this.events[e]||[];for(var r=0;r<this.events[e].length;r++)if(this.events[e][r]===t){this.events[e].splice(r,1);break}}},{key:"unlistenAll",value:function(){for(e in this.events.length)delete this.events[e]}}]),t}()},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.transformGetObservationsResponse=t.prepareForGetObservations=t.ConstraintInputs=t.validateConstraintInput=void 0;var i=r(5),n=["SUM","MAX","MIN","AVG"],o=function(e){var t=[];return e.forEach(function(e){if("virtual"===e.systemType)t.push(e.getVirtualProcedureJSON().system);else{if("insitu-fixed-point"!==e.systemType&&"insitu-mobile-point"!==e.systemType)throw e+": WRONG PROCEDURE SYSTEM TYPE!!!";t.push(e.getProcedureJSON().system)}}),t.toString()},s=function(e,t){var r=[];switch(t){case"simple":for(t=0;t<e.length;t++)0==t&&r.push(e[t]),0!=t&&t%2&&r.push(e[t]);return r}},a=function(e,t,r){switch(t){case"lessThan":if(parseInt(e[2])<parseInt(r))return[e[0],parseFloat(e[1]),parseInt(e[2])];break;case"lessThanAndEqual":if(parseInt(e[2])<=parseInt(r))return[e[0],parseFloat(e[1]),parseInt(e[2])];break;case"equal":if(parseInt(e[2])===parseInt(r))return[e[0],parseFloat(e[1]),parseInt(e[2])];break;case"greaterThanAndEqual":if(parseInt(e[2])>=parseInt(r))return[e[0],parseFloat(e[1]),parseInt(e[2])];break;case"greaterThan":if(parseInt(e[2])>parseInt(r))return[e[0],parseFloat(e[1]),parseInt(e[2])];break;case"between":if(parseInt(e[2])>=parseInt(r)[0]&&parseInt(e[2])<=parseInt(r)[1])return[e[0],parseFloat(e[1]),parseInt(e[2])];break;default:throw"WRONG CONSTRAINT TYPE FOR CHECKING QUALITY INDEX!!! SHOULD BE 'lessThan', 'lessThanAndEqual', 'equal', 'greaterThanAndEqual', 'greaterThan' or 'between'"}};t.validateConstraintInput=function(e,t){switch(e){case"between":return t.constructor===Array;case"lessThan":case"greaterThan":return t===parseInt(t,10);case"valueList":return t.constructor===Array;default:throw'Constraint type must be "between", "lessThan", "greaterThan" or "valueList"'}},t.ConstraintInputs={between:"interval",lessThan:"max",greaterThan:"min",valueList:"valueList"},t.prepareForGetObservations=function(e,t,r){var s={};if(r&&"aggregation"===r){if(r="",t.aggFunc&&t.aggInterval){if(r+="?",!(0<n.indexOf(t.aggFunc)))throw"AGGREGATE FUNCTION NOT RECOGNIZED! SHOULD BE 'MAX', 'MIN', 'SUM' OR 'AVG'!";r+="aggregatefunction="+t.aggFunc+"&aggregateinterval="+t.aggInterval,t.aggNoData&&t.aggNoDataQI&&(r+="&aggregatenodata="+t.aggNoData.toString()+"&aggregatenodataqi="+t.aggNoDataQI.toString())}s.aggregationURL=r}s.offering=e.offering.getOfferingJSON().name,s.procedureNames=o(e.procedures),t=e.observedProperties,r=[];for(var a=0;a<t.length;a++)r.push(t[a].definitionUrn);return s.observedPropertyUrns=r.toString(),s.begin=e.begin.constructor===i.Date?e.begin.getDateString():e.begin,s.end=e.end.constructor===i.Date?e.end.getDateString():e.end,s},t.transformGetObservationsResponse=function(e,t,r){switch(e){case"simple":e=t.data[0].result.DataArray.values;var i=[];for(t=0;t<e.length;t++)3<e[t].length?i.push(s(e[t],"simple")):i.push({date:e[t][0],measurement:e[t][1]});return i;case"constraint":e=t.data[0].result.DataArray.values;for(var i=[],n=0;n<e.length;n++){var o=a(e[n],r.type,r.quality);void 0!=o&&i.push(o)}return t.data[0].result.DataArray.values=i,t;default:throw"OBSERVATION METHOD TYPE NOT RECOGNIZED!"}}},function(e,t,r){function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.Configuration=void 0;var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,r,i){return r&&e(t.prototype,r),i&&e(t,i),t}}(),o=function e(t,r,i){null===t&&(t=Function.prototype);var n=Object.getOwnPropertyDescriptor(t,r);return void 0!==n?"value"in n?n.value:(r=n.get,void 0===r?void 0:r.call(i)):null!==(t=Object.getPrototypeOf(t))?e(t,r,i):void 0},s=r(0);e=r(1),t.Configuration=function(e){function t(e){if(!(this instanceof t))throw new TypeError("Cannot call a class as a function");var r;if(r=(t.__proto__||Object.getPrototypeOf(t)).call(this),!this)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r=!r||"object"!=typeof r&&"function"!=typeof r?this:r,r.serviceName=e.serviceName?e.serviceName:"default",r.server=e.server,r}return i(t,e),n(t,[{key:"fireEvent",value:function(e,r){o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"fire",this).call(this,e,r)}},{key:"on",value:function(e,r){o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"on",this).call(this,e,r)}},{key:"once",value:function(e,r){o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"once",this).call(this,e,r)}},{key:"off",value:function(e,r){o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"off",this).call(this,e,r)}},{key:"unlistenAll",value:function(){o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"unlistenAll",this).call(this)}},{key:"getConf",value:function(){var e=this,t=this.server.getUrl()+"wa/istsos/services/"+this.serviceName+"/configsections",r={};return this.server.getLoginConfig()&&(r.headers=this.server.getLoginConfig()),s.HttpAPI.get(t,r).then(function(t){if(t.success)return e.fireEvent("CONFIGSECTIONS",t),t;throw t.message},function(e){throw e})}},{key:"getProvider",value:function(){var e=this,t=this.server.getUrl()+"wa/istsos/services/"+this.serviceName+"/configsections/provider",r={};return this.server.getLoginConfig()&&(r.headers=this.server.getLoginConfig()),s.HttpAPI.get(t,r).then(function(t){if(t.success)return e.fireEvent("PROVIDER",t),t;throw t.message},function(e){throw e})}},{key:"updateProvider",value:function(){var e=this,t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},r=this.server.getUrl()+"wa/istsos/services/"+this.serviceName+"/configsections/provider",i={};return this.server.getLoginConfig()&&(i.headers=this.server.getLoginConfig()),i.data=JSON.stringify(t),s.HttpAPI.put(r,i).then(function(t){if(t.success)return e.fireEvent("UPDATE_PROVIDER",t),t;throw t.message},function(e){throw e})}},{key:"getIdentification",value:function(){var e=this,t=this.server.getUrl()+"wa/istsos/services/"+this.serviceName+"/configsections/identification",r={};return this.server.getLoginConfig()&&(r.headers=this.server.getLoginConfig()),s.HttpAPI.get(t,r).then(function(t){if(t.success)return e.fireEvent("IDENTIFICATION",t),t;throw t.message},function(e){throw e})}},{key:"updateIdentification",value:function(){var e=this,t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},r=this.server.getUrl()+"wa/istsos/services/"+this.serviceName+"/configsections/identification",i={};return this.server.getLoginConfig()&&(i.headers=this.server.getLoginConfig()),i.data=JSON.stringify(t),s.HttpAPI.put(r,i).then(function(t){if(t.success)return e.fireEvent("UPDATE_IDENTIFICATION",t),t;throw t.message},function(e){throw e})}},{key:"getMqtt",value:function(){var e=this,t=this.server.getUrl()+"wa/istsos/services/"+this.serviceName+"/configsections/mqtt",r={};return this.server.getLoginConfig()&&(r.headers=this.server.getLoginConfig()),s.HttpAPI.get(t,r).then(function(t){if(t.success)return e.fireEvent("MQTT",t),t;throw t.message},function(e){throw e})}},{key:"updateMqtt",value:function(){var e=this,t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},r=this.server.getUrl()+"wa/istsos/services/"+this.serviceName+"/configsections/mqtt",i={};return this.server.getLoginConfig()&&(i.headers=this.server.getLoginConfig()),i.data=JSON.stringify(t),s.HttpAPI.put(r,i).then(function(t){if(t.success)return e.fireEvent("UPDATE_MQTT",t),t;throw t.message},function(e){throw e})}},{key:"getCrs",value:function(){var e=this,t=this.server.getUrl()+"wa/istsos/services/"+this.serviceName+"/configsections/geo",r={};return this.server.getLoginConfig()&&(r.headers=this.server.getLoginConfig()),s.HttpAPI.get(t,r).then(function(t){if(t.success)return e.fireEvent("CRS",t),t;throw t.message},function(e){throw e})}},{key:"updateCrs",value:function(){var e=this,t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},r=this.server.getUrl()+"wa/istsos/services/"+this.serviceName+"/configsections/geo",i={};return this.server.getLoginConfig()&&(i.headers=this.server.getLoginConfig()),i.data=JSON.stringify(t),s.HttpAPI.put(r,i).then(function(t){if(t.success)return e.fireEvent("UPDATE_CRS",t),t;throw t.message},function(e){throw e})}},{key:"getObservationConf",value:function(){var e=this,t=this.server.getUrl()+"wa/istsos/services/"+this.serviceName+"/configsections/getobservation",r={};return this.server.getLoginConfig()&&(r.headers=this.server.getLoginConfig()),s.HttpAPI.get(t,r).then(function(t){if(t.success)return e.fireEvent("OBSERVATION_CONF",t),t;throw t.message},function(e){throw e})}},{key:"updateObservationConf",value:function(){var e=this,t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},r=this.server.getUrl()+"wa/istsos/services/"+this.serviceName+"/configsections/getobservation",i={};return this.server.getLoginConfig()&&(i.headers=this.server.getLoginConfig()),i.data=JSON.stringify(t),s.HttpAPI.put(r,i).then(function(t){if(t.success)return e.fireEvent("UPDATE_OBSERVATION_CONF",t),t;throw t.message},function(e){throw e})}},{key:"getProxy",value:function(){var e=this,t=this.server.getUrl()+"wa/istsos/services/"+this.serviceName+"/configsections/serviceurl",r={};return this.server.getLoginConfig()&&(r.headers=this.server.getLoginConfig()),s.HttpAPI.get(t,r).then(function(t){if(t.success)return e.fireEvent("PROXY",t),t;throw t.message},function(e){throw e})}},{key:"updateProxy",value:function(){var e=this,t={url:(0<arguments.length&&void 0!==arguments[0]?arguments[0]:"")||""},r=this.server.getUrl()+"wa/istsos/services/"+this.serviceName+"/configsections/serviceurl",i={};return this.server.getLoginConfig()&&(i.headers=this.server.getLoginConfig()),i.data=JSON.stringify(t),s.HttpAPI.put(r,i).then(function(t){if(t.success)return e.fireEvent("UPDATE_PROXY",t),t;throw t.message},function(e){throw e})}},{key:"getEpsgCodes",value:function(){var e=this,t=this.server.getUrl()+"wa/istsos/services/"+this.serviceName+"/epsgs",r={};return this.server.getLoginConfig()&&(r.headers=this.server.getLoginConfig()),s.HttpAPI.get(t,r).then(function(t){if(t.success)return e.fireEvent("EPSG_CODES",t),t;throw t.message},function(e){throw e})}}]),t}(e.EventEmitter)},function(e,t,r){function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.ProcedureBase=void 0;var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,r,i){return r&&e(t.prototype,r),i&&e(t,i),t}}(),o=function e(t,r,i){null===t&&(t=Function.prototype);var n=Object.getOwnPropertyDescriptor(t,r);return void 0!==n?"value"in n?n.value:(r=n.get,void 0===r?void 0:r.call(i)):null!==(t=Object.getPrototypeOf(t))?e(t,r,i):void 0};e=r(1),t.ProcedureBase=function(e){function t(e){if(!(this instanceof t))throw new TypeError("Cannot call a class as a function");var r;if(r=(t.__proto__||Object.getPrototypeOf(t)).call(this),!this)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r=!r||"object"!=typeof r&&"function"!=typeof r?this:r,r.name=e.name,r.description=e.description||"",r.keywords=e.keywords||"",r.foi_name=e.foi_name,r.epsg=e.epsg,r.coordinates=[e.x,e.y,e.z],r.outputs=e.outputs||[],r}return i(t,e),n(t,[{key:"fireEvent",value:function(e,r){o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"fire",this).call(this,e,r)}},{key:"on",value:function(e,r){o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"on",this).call(this,e,r)}},{key:"once",value:function(e,r){o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"once",this).call(this,e,r)}},{key:"off",value:function(e,r){o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"off",this).call(this,e,r)}},{key:"unlistenAll",value:function(){o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"unlistenAll",this).call(this)}},{key:"getOutputsProperty",value:function(){return this.outputs}},{key:"getProcedureBaseJSON",value:function(){var e={system_id:this.name,system:this.name,description:this.description,keywords:this.keywords,location:{type:"Feature",geometry:{type:"Point",coordinates:this.coordinates.toString().split(",")},crs:{type:"name",properties:{name:this.epsg.toString()}},properties:{name:this.foi_name}},outputs:[{name:"Time",definition:"urn:ogc:def:parameter:x-istsos:1.0:time:iso8601",uom:"iso8601",description:"",constraint:{}}],inputs:[],history:[],contacts:[],documentation:[],capabilities:[]};return this.outputs.forEach(function(t){e.outputs.push(t.getOutputJSON())}),e}},{key:"createContactForm",value:function(e){return{individualName:e.individualName||"",voice:e.voice||"",fax:e.fax||"",email:e.email||"",web:e.web||"",deliveryPoint:e.deliveryPoint||"",city:e.city||"",administrativeArea:e.administrativeArea||"",postalCode:e.postalCode||"",country:e.country||""}}},{key:"getCapabilitiesUom",value:function(){return"Âµs ms s min h d".split(" ")}},{key:"getCapabilitiesJson",value:function(){return[{name:"Memory Capacity",definition:"urn:x-ogc:def:classifier:x-istsos:1.0:memoryCapacity",uom:"Byte",combo:"Memory Capacity (Byte)"},{name:"Battery Current",definition:"urn:x-ogc:def:phenomenon:x-istsos:1.0:batteryCurrent",uom:"A.h",combo:"Battery Current (A.h)"}]}},{key:"getIdentificationNames",value:function(){return[{name:"Short Name",definition:"urn:x-ogc:def:identifier:x-istsos:1.0:shortName"},{name:"Long Name",definition:"urn:x-ogc:def:identifier:x-istsos:1.0:longName"},{name:"Manufacturer Name",definition:"urn:x-ogc:def:identifier:x-istsos:1.0:manufacturerName"},{name:"Model Number",definition:"urn:x-ogc:def:identifier:x-istsos:1.0:modelNumber"},{name:"Serial Number",definition:"urn:x-ogc:def:identifier:x-istsos:1.0:serialNumber"},{name:"Device ID",definition:"urn:x-ogc:def:identifier:x-istsos:1.0:deviceID"}]}}]),t}(e.EventEmitter)},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,r,i){return r&&e(t.prototype,r),i&&e(t,i),t}}();t.Date=function(){function e(t){if(!(this instanceof e))throw new TypeError("Cannot call a class as a function");this.year=t.year.toString(),this.month=9<t.month?t.month.toString():"0"+t.month.toString(),this.day=9<t.day?t.day.toString():"0"+t.day.toString(),this.hours=9<t.hours?t.hours.toString():"0"+t.hours.toString(),this.minutes=9<t.minutes?t.minutes.toString():"0"+t.minutes.toString(),this.seconds=9<t.seconds?t.seconds.toString():"0"+t.seconds.toString(),this.gmt=9<t.gmt?t.gmt.toString():"0"+t.gmt.toString(),this.description=t.opt_description||"Class for converting date&time to proper istSOS format"}return i(e,[{key:"getDateString",value:function(){return this.year+"-"+this.month+"-"+this.day+"T"+this.hours+":"+this.minutes+":"+this.seconds+"+"+this.gmt+":00"}},{key:"getDescription",value:function(){return this.description}}]),e}()},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.EventTypes={LOGIN:"loginReceived",ABOUT:"aboutReceived",STATUS:"statusReceived",CONFIGSECTIONS:"configSectionsReceived",PROVIDER:"providerReceived",UPDATE_PROVIDER:"PUT ProviderReceived",IDENTIFICATION:"identificationReceived",UPDATE_IDENTIFICATION:"PUT identificationReceived",MQTT:"mqttReceived",UPDATE_MQTT:"PUT mqttReceived",CRS:"crsReceived",UPDATE_CRS:"PUT crsReceived",OBSERVATION_CONF:"observationConfigurationReceived",UPDATE_OBSERVATION_CONF:"PUT observationConfigurationReceived",PROXY:"proxyReceived",UPDATE_PROXY:"PUT proxyReceived",SERVICE:"serviceReceived",SERVICES:"servicesListReceived",NEW_SERVICE:"POST serviceReceived",DELETE_SERVICE:"DELETE serviceReceived",DATABASE:"databaseReceived",UPDATE_DATABASE:"PUT databaseReceived",VALIDATE_DB:"POST validateDbReceived",EPSG_CODES:"epsgsReceived",SYSTEM_TYPES:"systemTypesReceived",NEW_OFFERING:"POST offeringReceived",OFFERING_NAMES:"offeringNamesReceived",OFFERING_LIST:"offeringListReceived",DELETE_OFFERING:"DELETE offeringReceived",UPDATE_OFFERING:"PUT offeringReceived",MEMBERLIST:"memberlistReceived",NONMEMBERLIST:"nonmemberlistReceived",OBSERVED_PROPERTIES:"observedPropertiesReceived",OBSERVED_PROPERTY:"observedPropertyReceived",NEW_OBSERVED_PROPERTY:"POST observedPropertyReceived",UPDATE_OBSERVED_PROPERTY:"PUT observedPropertyReceived",DELETE_OBSERVED_PROPERTY:"DELETE observedPropertyReceived",DATAQUALITIES:"dataQualitiesReceived",DATAQUALITY:"dataQualityReceived",NEW_DATAQUALITY:"POST dataQualityReceived",UPDATE_DATAQUALITY:"PUT dataQualityReceived",DELETE_DATAQUALITY:"DELETE dataQualityReceived",UOM:"unitOfMeasureReceived",UOMS:"unitsOfMeasureReceived",NEW_UOM:"POST unitOfMeasureReceived",UPDATE_UOM:"PUT unitOfMeasureReceived",DELETE_UOM:"DELETE unitOfMeasureReceived",GET_CODE:"codeReceived",NEW_CODE:"POST codeReceived",UPDATE_CODE:"PUT codeReceived",DELETE_CODE:"DELETE codeReceived",RATING_CURVE:"ratingCurveReceived",NEW_RATING_CURVE:"POST ratingCurveReceived",DELETE_RATING_CURVE:"DELETE ratingCurveReceived",NEW_PROCEDURE:"POST procedureReceived",UPDATE_PROCEDURE:"PUT procedureReceived",DELETE_PROCEDURE:"DELETE procedureReceived",ADD_TO_OFFERING:"POST addToOfferingReceived",REMOVE_FROM_OFFERING:"DELETE removeFromOfferingReceived",VIRTUAL_PROCEDURES:"virtualProceduresReceived",VIRTUAL_PROCEDURE:"virtualProcedureReceived",NEW_VIRTUAL_PROCEDURE:"POST virtualProcedureReceived",UPDATE_V_PROCEDURE:"PUT virtualProcedureReceived",DELETE_V_PROCEDURE:"DELETE virtualProcedureReceived",PROCEDURES:"proceduresReceived",PROCEDURE:"procedureReceived",GEOJSON:"geojsonReceived",GETOBSERVATIONS:"getobservationsReceived",GETOBSERVATIONS_AGG:"getobservationsAggregationReceived",GETOBSERVATIONS_SIMPLIFIED:"getobservationsDataReceived",GETOBSERVATIONS_BY_QUALITY:"getObservationsByQualityIndexReceived"}},function(e,t,r){function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.Offering=void 0;var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,r,i){return r&&e(t.prototype,r),i&&e(t,i),t}}(),o=function e(t,r,i){null===t&&(t=Function.prototype);var n=Object.getOwnPropertyDescriptor(t,r);return void 0!==n?"value"in n?n.value:(r=n.get,void 0===r?void 0:r.call(i)):null!==(t=Object.getPrototypeOf(t))?e(t,r,i):void 0},s=r(0);e=r(1),t.Offering=function(e){function t(e){if(!(this instanceof t))throw new TypeError("Cannot call a class as a function");var r;if(r=(t.__proto__||Object.getPrototypeOf(t)).call(this),!this)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r=!r||"object"!=typeof r&&"function"!=typeof r?this:r,r.offeringName=e.offeringName,r.offeringDescription=e.offeringDescription||"",r.active=e.active||!1,r.expirationDate=e.expirationDate&&e.expirationDate.constructor===istsos.Date?e.expirationDate.getDateString():"",r.service=e.service,r.memberProcedures=[],e.service.addOffering(r),r}return i(t,e),n(t,[{key:"fireEvent",value:function(e,r){o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"fire",this).call(this,e,r)}},{key:"on",value:function(e,r){o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"on",this).call(this,e,r)}},{key:"once",value:function(e,r){o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"once",this).call(this,e,r)}},{key:"off",value:function(e,r){o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"off",this).call(this,e,r)}},{key:"unlistenAll",value:function(){o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"unlistenAll",this).call(this)}},{key:"addProcedure",value:function(e){this.memberProcedures.push(e)}},{key:"updateOffering",value:function(e){var t=this,r=this.offeringName;return this.offeringName=e.newName||this.offeringName,this.offeringDescription=e.newDescription||this.offeringDescription,this.active=e.newActive||this.active,this.expirationDate=e.newExpirationDate||this.expirationDate,e=this.service.server.getUrl()+"wa/istsos/services/"+this.service.getServiceJSON().service+"/offerings/"+r,r={},this.service.server.getLoginConfig()&&(r.headers=this.service.server.getLoginConfig()),r.data=JSON.stringify(this.getUomJSON()),s.HttpAPI.put(e,r).then(function(e){if(e.success)return t.fireEvent("UPDATE_OFFERING",e),e;throw e.message},function(e){throw e})}},{key:"deleteOffering",value:function(){for(var e=this,t=0;t<this.service.getOfferingsProperty().length;t++)this.offeringName===this.service.getOfferingsProperty()[t].name&&this.service.getOfferingsProperty().splice(t,1);var t=this.service.server.getUrl()+"wa/istsos/services/"+this.service.getServiceJSON().service+"/offerings/"+this.getOfferingJSON().name,r={name:this.getOfferingJSON().name,description:this.getOfferingJSON().description},i={};return this.service.server.getLoginConfig()&&(i.headers=this.service.server.getLoginConfig()),i.data=JSON.stringify(r),s.HttpAPI.delete(t,i).then(function(t){if(t.success)return e.fireEvent("DELETE_OFFERING",t),t;throw t.message},function(e){throw e})}},{key:"getMemberProceduresProperty",value:function(){return this.memberProcedures}},{key:"getMemberProcedures",value:function(){var e=this,t=this.service.server.getUrl()+"wa/istsos/services/"+this.service.getServiceJSON().service+"/offerings/"+this.getOfferingJSON().name+"/procedures/operations/memberslist",r={};return this.service.server.getLoginConfig()&&(r.headers=this.service.server.getLoginConfig()),s.HttpAPI.get(t,r).then(function(t){if(t.success)return e.fireEvent("MEMBERLIST",t),t;throw t.message},function(e){throw e})}},{key:"getNonMemberProcedures",value:function(){var e=this,t=this.service.server.getUrl()+"wa/istsos/services/"+this.service.getServiceJSON().service+"/offerings/"+this.getOfferingJSON().name+"/procedures/operations/nonmemberslist",r={};return this.service.server.getLoginConfig()&&(r.headers=this.service.server.getLoginConfig()),s.HttpAPI.get(t,r).then(function(t){if(t.success)return e.fireEvent("NONMEMBERLIST",t),t;throw t.message},function(e){throw e})}},{key:"getOfferingJSON",value:function(){var e={name:this.offeringName,description:this.offeringDescription,expiration:this.expirationDate};return!0===this.active&&(e.active="on"),e}}]),t}(e.EventEmitter)},function(e,t,r){function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.DataQuality=void 0;var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,r,i){return r&&e(t.prototype,r),i&&e(t,i),t}}(),o=function e(t,r,i){null===t&&(t=Function.prototype);var n=Object.getOwnPropertyDescriptor(t,r);return void 0!==n?"value"in n?n.value:(r=n.get,void 0===r?void 0:r.call(i)):null!==(t=Object.getPrototypeOf(t))?e(t,r,i):void 0},s=r(0);e=r(1),t.DataQuality=function(e){function t(e){if(!(this instanceof t))throw new TypeError("Cannot call a class as a function");var r;if(r=(t.__proto__||Object.getPrototypeOf(t)).call(this),!this)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r=!r||"object"!=typeof r&&"function"!=typeof r?this:r,r.code=e.codeDQ,r.name=e.nameDQ,r.description=e.descrDQ||"",r.service=e.service,e.service.addDataQuality(r),r}return i(t,e),n(t,[{key:"fireEvent",value:function(e,r){o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"fire",this).call(this,e,r)}},{key:"on",value:function(e,r){o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"on",this).call(this,e,r)}},{key:"once",value:function(e,r){o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"once",this).call(this,e,r)}},{key:"off",value:function(e,r){o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"off",this).call(this,e,r)}},{key:"unlistenAll",value:function(){o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"unlistenAll",this).call(this)}},{key:"getDataQualityJSON",value:function(){return{code:this.code.toString(),name:this.name,description:this.description}}},{key:"updateDataQuality",value:function(e){var t=this,r=this.code;return this.code=e.newCodeDQ||this.code,this.name=e.newNameDQ||this.name,this.description=e.newDescrDQ||this.description,e=this.service.server.getUrl()+"wa/istsos/services/"+this.service.getServiceJSON().service+"/dataqualities/"+r,r={},this.service.server.getLoginConfig()&&(r.headers=this.service.server.getLoginConfig()),r.data=JSON.stringify(this.getDataQualityJSON()),s.HttpAPI.put(e,r).then(function(e){if(e.success)return t.fireEvent("UPDATE_DATAQUALITY",e),e;throw e.message},function(e){throw e})}},{key:"deleteDataQuality",value:function(){for(var e=this,t=this.service.getDataQualitiesProperty(),r=0;r<t.length;r++)this.code===t[r].code&&t.splice(r,1);return t=this.service.server.getUrl()+"wa/istsos/services/"+this.service.getServiceJSON().service+"/dataqualities/"+this.getDataQualityJSON().code,r={},this.service.server.getLoginConfig()&&(r.headers=this.service.server.getLoginConfig()),r.data=JSON.stringify(this.getDataQualityJSON()),s.HttpAPI.delete(t,r).then(function(t){if(t.success)return e.fireEvent("DELETE_DATAQUALITY",t),t;throw t.message},function(e){throw e})}}]),t}(e.EventEmitter)},function(e,t,r){function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.Database=void 0;var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,r,i){return r&&e(t.prototype,r),i&&e(t,i),t}}(),o=function e(t,r,i){null===t&&(t=Function.prototype);var n=Object.getOwnPropertyDescriptor(t,r);return void 0!==n?"value"in n?n.value:(r=n.get,void 0===r?void 0:r.call(i)):null!==(t=Object.getPrototypeOf(t))?e(t,r,i):void 0},s=r(0);e=r(1),t.Database=function(e){function t(e){if(!(this instanceof t))throw new TypeError("Cannot call a class as a function");var r;if(r=(t.__proto__||Object.getPrototypeOf(t)).call(this),!this)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r=!r||"object"!=typeof r&&"function"!=typeof r?this:r,r.dbname=e.dbname,r.host=e.host,r.user=e.user,r.password=e.password,r.port=e.port,r}return i(t,e),n(t,[{key:"fireEvent",value:function(e,r){o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"fire",this).call(this,e,r)}},{key:"on",value:function(e,r){o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"on",this).call(this,e,r)}},{key:"once",value:function(e,r){o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"once",this).call(this,e,r)}},{key:"off",value:function(e,r){o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"off",this).call(this,e,r)}},{key:"unlistenAll",value:function(){o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"unlistenAll",this).call(this)}},{key:"getDb",value:function(e,t){var r=this;e=e||"default",e=t.getUrl()+"wa/istsos/services/"+e+"/configsections/connection";var i={};return t.getLoginConfig()&&(i.headers=t.getLoginConfig()),s.HttpAPI.get(e,i).then(function(e){if(e.success)return r.fireEvent("DATABASE",e),e;throw e.message},function(e){throw e})}},{key:"setDb",value:function(e,t,r){var i=this;return this.dbname=r.dbname||this.dbname,this.host=r.host||this.host,this.password=r.password||this.password,this.port=r.port||this.port,t=t?t.getServiceJSON().service:"default",t=e.getUrl()+"wa/istsos/services/"+t+"/configsections/connection",r={},e.getLoginConfig()&&(r.headers=e.getLoginConfig()),r.data=JSON.stringify(this.getDbJSON()),s.HttpAPI.put(t,r).then(function(e){if(e.success)return i.fireEvent("UPDATE_DATABASE",e),e;throw e.message},function(e){throw e})}},{key:"validateDb",value:function(e){var t=this,r=e.getUrl()+"wa/istsos/operations/validatedb",i={};return e.getLoginConfig()&&(i.headers=e.getLoginConfig()),i.data=JSON.stringify(this.getDbJSON()),s.HttpAPI.post(r,i).then(function(e){if(e.success)return t.fireEvent("VALIDATE_DB",e),e;throw e.message},function(e){throw e})}},{key:"getDbJSON",value:function(){return{dbname:this.dbname,host:this.host,user:this.user,password:this.password,port:this.port.toString()}}}]),t}(e.EventEmitter)},function(e,t,r){function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.ObservedProperty=void 0;var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,r,i){return r&&e(t.prototype,r),i&&e(t,i),t}}(),o=function e(t,r,i){null===t&&(t=Function.prototype);var n=Object.getOwnPropertyDescriptor(t,r);return void 0!==n?"value"in n?n.value:(r=n.get,void 0===r?void 0:r.call(i)):null!==(t=Object.getPrototypeOf(t))?e(t,r,i):void 0},s=r(0);e=r(1);var a=r(2);t.ObservedProperty=function(e){function t(e){if(!(this instanceof t))throw new TypeError("Cannot call a class as a function");var r;if(r=(t.__proto__||Object.getPrototypeOf(t)).call(this),!this)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r=!r||"object"!=typeof r&&"function"!=typeof r?this:r,r.observedName=e.observedName,r.definitionUrn=e.definitionUrn,r.observedDescr=e.observedDescr||"",r.constraint=null,!0===(0,a.validateConstraintInput)(e.constraintType,e.value)?(r.constraint={},r.constraint.role="urn:x-ogc:def:classifiers:x-istsos:1.0:qualityIndexCheck:level0",r.constraint[a.ConstraintInputs[e.constraintType]]=e.value.constructor===Array?e.value.toString().split(","):e.value.toString()):console.log("Input constraintType and constraintValue for property <"+r.observedName.toUpperCase()+"> are INCORRECT or INTENTIONALLY NULL!!! "),r.service=e.service,r.proceduresIncluded=[],r.updateProceduresIncluded(),e.service.addObservedProperty(r),r}return i(t,e),n(t,[{key:"fireEvent",value:function(e,r){o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"fire",this).call(this,e,r)}},{key:"on",value:function(e,r){o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"on",this).call(this,e,r)}},{key:"once",value:function(e,r){o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"once",this).call(this,e,r)}},{key:"off",value:function(e,r){o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"off",this).call(this,e,r)}},{key:"unlistenAll",value:function(){o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"unlistenAll",this).call(this)}},{key:"updateProceduresIncluded",value:function(){var e=this.service.getProceduresProperty(),t=this.service.getVirtualProceduresProperty(),e=e.concat(t);if(0!==e.length)for(t=0;t<e.length;t++)for(var r=0;r<e[t].getOutputsProperty().length;r++)e[t].getOutputsProperty()[r].name&&this.getProceduresIncluded().push(e[t])}},{key:"getProceduresIncluded",value:function(){return this.proceduresIncluded}},{key:"getObservedPropertyJSON",value:function(){return{name:this.observedName,definition:this.definitionUrn,description:this.observedDescr,constraint:this.constraint}}},{key:"updateObservedProperty",value:function(e){var t=this,r=this.definitionUrn;return this.observedName=e.newPropertyName||this.observedName,this.definitionUrn=e.newDefinitionUrn||this.definitionUrn,this.observedDescr=e.newPropertyName||this.observedDescr,!0===(0,a.validateConstraintInput)(e.constraintType,e.value)?(this.constraint={},this.constraint.role="urn:x-ogc:def:classifiers:x-istsos:1.0:qualityIndexCheck:level0",this.constraint[a.ConstraintInputs[e.constraintType]]=e.value.constructor===Array?e.value.toString().split(","):e.value.toString()):console.log("Input constraintType and constraintValue for property <"+this.observedName.toUpperCase()+"> are INCORRECT or INTENTIONALLY NULL!!! "),e=this.service.server.getUrl()+"wa/istsos/services/"+this.service.getServiceJSON().service+"/observedproperties/"+r,r={},this.service.server.getLoginConfig()&&(r.headers=this.service.server.getLoginConfig()),r.data=JSON.stringify(this.getObservedPropertyJSON()),s.HttpAPI.put(e,r).then(function(e){if(e.success)return t.fireEvent("UPDATE_OBSERVED_PROPERTY",e),e;throw e.message},function(e){throw e})}},{key:"deleteObservedProperty",value:function(){var e=this,t=this.service.getProceduresProperty(),r=this.service.getVirtualProceduresProperty(),i=this.service.getObservedPropertiesProperty(),n=[];t.concat(r).forEach(function(e){n.concat(e.getOutputsProperty())});for(var t=this.observedName,r=!1,o=0;o<n.length;o++)if(t===n[o].getOutputJSON().name){alert("CONNECTED TO PROCEDURE"),r=!0;break}if(!1===r)for(t=0;t<i.length;t++)this===i[t]&&i.splice(t,1);return i=this.service.server.getUrl()+"wa/istsos/services/"+this.service.getServiceJSON().service+"/observedproperties/"+this.getObservedPropertyJSON().definition,t={},this.service.server.getLoginConfig()&&(t.headers=this.service.server.getLoginConfig()),t.data=JSON.stringify(this.getObservedPropertyJSON()),s.HttpAPI.delete(i,t).then(function(t){if(t.success)return e.fireEvent("DELETE_OBSERVED_PROPERTY",t),t;throw t.message},function(e){throw e})}}]),t}(e.EventEmitter)},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.Output=void 0;var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,r,i){return r&&e(t.prototype,r),i&&e(t,i),t}}(),n=r(2);t.Output=function(){function e(t){if(!(this instanceof e))throw new TypeError("Cannot call a class as a function");this.observedProperty=t.property,this.uom=t.uom,this.description=t.description||"",this.constraint={},!0===(0,n.validateConstraintInput)(t.opt_constraintType,t.opt_constraintValue)?(this.constraint.role="urn:ogc:def:classifiers:x-istsos:1.0:qualityIndex:check:reasonable",this.constraint[istsos.observedProperty.ConstraintInputs[opt_constraintType]]=opt_constraintValue.constructor===Array?opt_constraintValue.toString().split(","):opt_constraintValue.toString()):console.log("Input constraintType and constraintValue are incorrect or intentionally null/undefined!!! ")}return i(e,[{key:"getOutputJSON",value:function(){return{name:this.observedProperty.getObservedPropertyJSON().name,definition:this.observedProperty.getObservedPropertyJSON().definition,uom:this.uom.getUomJSON().name,description:this.description||"",constraint:this.constraint}}}]),e}()},function(e,t,r){function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.Procedure=void 0;var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,r,i){return r&&e(t.prototype,r),i&&e(t,i),t}}(),o=function e(t,r,i){null===t&&(t=Function.prototype);var n=Object.getOwnPropertyDescriptor(t,r);return void 0!==n?"value"in n?n.value:(r=n.get,void 0===r?void 0:r.call(i)):null!==(t=Object.getPrototypeOf(t))?e(t,r,i):void 0};e=r(4);var s=r(0);t.Procedure=function(e){function t(e){if(!(this instanceof t))throw new TypeError("Cannot call a class as a function");var r;if(r=(t.__proto__||Object.getPrototypeOf(t)).call(this,{name:e.name,description:e.description,keywords:e.keywords,foi_name:e.foi_name,epsg:e.epsg,x:e.x,y:e.y,z:e.z,outputs:e.outputs}),!this)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r=!r||"object"!=typeof r&&"function"!=typeof r?this:r,r.systemType="insitu-fixed-point"===e.systemType||"insitu-mobile-point"===e.systemType?e.systemType:null,r.sensorType=e.sensorType||"",r.service=e.service,r.service.addProcedure(r),r.service.getOfferingsProperty()[0].getMemberProceduresProperty().push(r),r}return i(t,e),n(t,[{key:"fireEvent",value:function(e,r){o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"fire",this).call(this,e,r)}},{key:"on",value:function(e,r){o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"on",this).call(this,e,r)}},{key:"once",value:function(e,r){o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"once",this).call(this,e,r)}},{key:"off",value:function(e,r){o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"off",this).call(this,e,r)}},{key:"unlistenAll",value:function(){o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"unlistenAll",this).call(this)}},{key:"getProcedureJSON",value:function(){var e=o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"getProcedureBaseJSON",this).call(this);return e.classification=[{name:"System Type",definition:"urn:ogc:def:classifier:x-istsos:1.0:systemType",value:"insitu-mobile-point"===this.systemType||"insitu-fixed-point"===this.systemType?this.systemType:null},{name:"Sensor Type",definition:"urn:ogc:def:classifier:x-istsos:1.0:sensorType",value:this.sensorType}],e}},{key:"updateProcedure",value:function(e){var t=this,r=this.name;this.name=e.name||this.name,this.description=e.description||this.description,this.keywords=e.keywords||this.keywords,this.foi_name=e.foi_name||this.foi_name,this.epsg=option.sepsg||this.epsg,this.coordinates=[e.x,e.y,e.z];var i=this.outputs;return(e.outputs||0!==e.outputs.length)&&(i.splice(1,i.length-1),e.outputs.forEach(function(e){i.push(e)})),this.systemType="insitu-fixed-point"===e.systemType||"insitu-mobile-point"===e.systemType?e.systemType:null,this.sensorType=e.sensorType||"",e=this.service.server.getUrl()+"wa/istsos/services/"+this.service.getServiceJSON().service+"/procedures/"+r,r={},this.service.server.getLoginConfig()&&(r.headers=this.service.server.getLoginConfig()),r.data=JSON.stringify(this.getProcedureJSON()),s.HttpAPI.put(e,r).then(function(e){if(e.success)return t.fireEvent("UPDATE_PROCEDURE",e),e;throw e.message},function(e){throw e})}},{key:"deleteProcedure",value:function(){var e=this,t=this.service.getProceduresProperty(),r=this.getProcedureJSON();t.forEach(function(e){e.getProcedureJSON().system===r.system&&t.splice(t.indexOf(e),1)});var i=this.service.server.getUrl()+"wa/istsos/services/"+this.service.getServiceJSON().service+"/procedures/"+this.name,n={};return this.service.server.getLoginConfig()&&(n.headers=this.service.server.getLoginConfig()),s.HttpAPI.delete(i,n).then(function(t){if(t.success)return e.fireEvent("DELETE_PROCEDURE",t),t;throw t.message},function(e){throw e})}},{key:"addMembershipToOffering",value:function(e){var t=this;e.getMemberProceduresProperty().push(this);var r=this.service.server.getUrl()+"wa/istsos/services/"+this.service.getServiceJSON().service+"/offerings/"+e.getOfferingJSON().name+"/procedures";e=[{offering:e.getOfferingJSON().name,procedure:this.getProcedureJSON().system}];var i={};return this.service.server.getLoginConfig()&&(i.headers=this.service.server.getLoginConfig()),i.data=JSON.stringify(e),s.HttpAPI.post(r,i).then(function(e){if(e.success)return t.fireEvent("ADD_TO_OFFERING",e),e;throw e.message},function(e){throw e})}},{key:"removeMembershipFromOffering",value:function(e){var t=this,r=e.getMemberProceduresProperty(),i=this.name;r.forEach(function(e){e.name===i&&r.splice(r.indexOf(e),1)});var n=this.service.server.getUrl()+"wa/istsos/services/"+this.service.getServiceJSON().service+"/offerings/"+e.getOfferingJSON().name+"/procedures/"+this.getProcedureJSON().system;e=[{offering:e.getOfferingJSON().name,procedure:this.getProcedureJSON().system}];var o={};return this.service.server.getLoginConfig()&&(o.headers=this.service.server.getLoginConfig()),o.data=JSON.stringify(e),s.HttpAPI.delete(n,o).then(function(e){if(e.success)return t.fireEvent("REMOVE_FROM_OFFERING",e),e;throw e.message},function(e){throw e})}},{key:"getOutputsProperty",value:function(){return o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"getOutputsProperty",this).call(this)}}]),t}(e.ProcedureBase)},function(e,t,r){(function(e){function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.Server=void 0;var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,r,i){return r&&e(t.prototype,r),i&&e(t,i),t}}(),o=function e(t,r,i){null===t&&(t=Function.prototype);var n=Object.getOwnPropertyDescriptor(t,r);return void 0!==n?"value"in n?n.value:(r=n.get,void 0===r?void 0:r.call(i)):null!==(t=Object.getPrototypeOf(t))?e(t,r,i):void 0},s=r(3),a=r(0),u=r(1);t.Server=function(t){function r(e){if(!(this instanceof r))throw new TypeError("Cannot call a class as a function");var t;if(t=(r.__proto__||Object.getPrototypeOf(r)).call(this),!this)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t=!t||"object"!=typeof t&&"function"!=typeof t?this:t,t.name=e.name,t.url="/"===e.url.charAt(e.url.length-1)?e.url:e.url+"/",t.defaultDb=e.defaultDb,t.config=e.opt_config||new s.Configuration({serviceName:null,server:t}),t.loginConfig=null,t.services=[],t}return i(r,t),n(r,[{key:"fireEvent",value:function(e,t){o(r.prototype.__proto__||Object.getPrototypeOf(r.prototype),"fire",this).call(this,e,t)}},{key:"on",value:function(e,t){o(r.prototype.__proto__||Object.getPrototypeOf(r.prototype),"on",this).call(this,e,t)}},{key:"once",value:function(e,t){o(r.prototype.__proto__||Object.getPrototypeOf(r.prototype),"once",this).call(this,e,t)}},{key:"off",value:function(e,t){o(r.prototype.__proto__||Object.getPrototypeOf(r.prototype),"off",this).call(this,e,t)}},{key:"unlistenAll",value:function(){o(r.prototype.__proto__||Object.getPrototypeOf(r.prototype),"unlistenAll",this).call(this)}},{key:"setLoginConfig",value:function(t,r){this.loginConfig={Authorization:"Basic "+new e(t+":"+r).toString("base64")}}},{key:"removeLoginConfig",value:function(){this.loginConfig=null}},{key:"getLoginConfig",value:function(){return this.loginConfig}},{key:"getService",value:function(e){var t=this;e=this.url+"wa/istsos/services/"+e;var r={};return this.getLoginConfig()&&(r.headers=this.getLoginConfig()),a.HttpAPI.get(e,r).then(function(e){if(e.success)return t.fireEvent("SERVICE",e),e;throw e.message},function(e){throw e})}},{key:"addService",value:function(e){this.services.push(e)}},{key:"registerService",value:function(e){var t=this,r=this.getUrl()+"wa/istsos/services",i={};return this.getLoginConfig()&&(i.headers=this.getLoginConfig()),i.data=JSON.stringify(e.getServiceJSON()),a.HttpAPI.post(r,i).then(function(e){if(e.success)return t.fireEvent("NEW_SERVICE",e),e;throw e.message},function(e){throw e})}},{key:"deleteService",value:function(e){for(var t=this,r=0;r<this.services.length;r++)this.services[r].getServiceJSON().service===e.getServiceJSON().service&&this.services.splice(r,1);var r=this.url+"wa/istsos/services/"+e.name,i={};return this.getLoginConfig()&&(i.headers=this.getLoginConfig()),i.data=JSON.stringify({name:e.name}),a.HttpAPI.delete(r,i).then(function(e){if(e.success)return t.fireEvent("DELETE_SERVICE",e),e;throw e.message},function(e){throw e})}},{key:"getStatus",value:function(){var e=this,t=this.url+"wa/istsos/operations/status",r={};return this.getLoginConfig()&&(r.headers=this.getLoginConfig()),a.HttpAPI.get(t,r).then(function(t){if(t.success)return e.fireEvent("STATUS",t),t;throw t.message},function(e){throw e})}},{key:"getAboutInfo",value:function(){var e=this,t=this.url+"wa/istsos/operations/about",r={};return this.getLoginConfig()&&(r.headers=this.getLoginConfig()),a.HttpAPI.get(t,r).then(function(t){if(t.success)return e.fireEvent("ABOUT",t),t;throw t.message},function(e){throw e})}},{key:"getConfig",value:function(){return this.config.getConf()}},{key:"getConfigProperty",value:function(){return this.config}},{key:"getServicesProperty",value:function(){return this.services}},{key:"getServices",value:function(){var e=this,t=this.url+"wa/istsos/services",r={};return this.getLoginConfig()&&(r.headers=this.getLoginConfig()),a.HttpAPI.get(t,r).then(function(t){if(t.success)return e.fireEvent("SERVICES",t),t;throw t.message},function(e){throw e})}},{key:"getDefaultDb",value:function(){return this.defaultDb.getDb("default",this)}},{key:"getDefaultDbProperty",value:function(){return this.defaultDb}},{key:"getUrl",value:function(){return this.url}}]),r}(u.EventEmitter)}).call(t,r(20).Buffer)},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,r,i){return r&&e(t.prototype,r),i&&e(t,i),t}}();t.ServerContainer=function(){function e(){if(!(this instanceof e))throw new TypeError("Cannot call a class as a function");this.servers=[]}return i(e,[{key:"getServer",value:function(e){if(!e||"string"!=typeof e)throw"Parameter must be a string representing the name of the server!";var t=!0,r=!1,i=void 0;try{for(var n,o=this.servers[Symbol.iterator]();!(t=(n=o.next()).done);t=!0){var s=n.value;if(s.name===e)return s}}catch(e){r=!0,i=e}finally{try{!t&&o.return&&o.return()}finally{if(r)throw i}}}},{key:"getServers",value:function(){return this.servers}},{key:"addServer",value:function(e){if(!e||e.constructor!=istsos.Server)throw"Parameter must be an instance of istsos.Server class!";this.servers.push(e)}},{key:"removeServer",value:function(e){if("string"==typeof e){var t=!0,r=!1,i=void 0;try{for(var n,o=this.servers[Symbol.iterator]();!(t=(n=o.next()).done);t=!0){var s=n.value;if(s.name===e){this.servers.splice(this.servers.indexOf(s),1);break}}}catch(e){r=!0,i=e}finally{try{!t&&o.return&&o.return()}finally{if(r)throw i}}}else{if(e.constructor!=istsos.Server)throw"Parameter must be a string representing the name of the server or an instance of istsos.Server class!";this.servers.splice(this.servers.indexOf(e),1)}}}]),e}()},function(e,t,r){function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.Service=void 0;var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,r,i){return r&&e(t.prototype,r),i&&e(t,i),t}}(),o=function e(t,r,i){null===t&&(t=Function.prototype);var n=Object.getOwnPropertyDescriptor(t,r);return void 0!==n?"value"in n?n.value:(r=n.get,void 0===r?void 0:r.call(i)):null!==(t=Object.getPrototypeOf(t))?e(t,r,i):void 0};e=r(1);var s=r(0),a=r(3),u=r(7),c=r(2);t.Service=function(e){function t(e){if(!(this instanceof t))throw new TypeError("Cannot call a class as a function");var r;if(r=(t.__proto__||Object.getPrototypeOf(t)).call(this),!this)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r=!r||"object"!=typeof r&&"function"!=typeof r?this:r,r.name=e.name,r.db=e.opt_db||e.server.getDefaultDbProperty(),r.epsg=e.opt_epsg||null,r.config=e.opt_config||new a.Configuration({serviceName:e.name,server:e.server}),r.server=e.server,r.offerings=[],r.procedures=[],r.virtualProcedures=[],r.observedProperties=[],r.uoms=[],r.dataQualities=[],e.server.addService(r),new u.Offering({offeringName:"temporary",offeringDescription:"temporary offering to hold self-registered procedures/sensors waiting for service adimistration acceptance",active:!0,expirationDate:"",service:r}),r}return i(t,e),n(t,[{key:"fireEvent",value:function(e,r){o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"fire",this).call(this,e,r)}},{key:"on",value:function(e,r){o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"on",this).call(this,e,r)}},{key:"once",value:function(e,r){o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"once",this).call(this,e,r)}},{key:"off",value:function(e,r){o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"off",this).call(this,e,r)}},{key:"unlistenAll",value:function(){o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"unlistenAll",this).call(this)}},{key:"getServiceJSON",value:function(){var e={service:this.name};return this.epsg&&(e.epsg=this.epsg.toString()),this.db!==this.server.getDefaultDbProperty()&&(e.dbname=this.db.dbname,e.host=this.db.host,e.user=this.db.user,e.password=this.db.password,e.port=this.db.port.toString()),e}},{key:"getOfferingsProperty",value:function(){return this.offerings}},{key:"getProceduresProperty",value:function(){return this.procedures}},{key:"getVirtualProceduresProperty",value:function(){return this.virtualProcedures}},{key:"getObservedPropertiesProperty",value:function(){return this.observedProperties}},{key:"getUomsProperty",value:function(){return this.uoms}},{key:"getDataQualitiesProperty",value:function(){return this.dataQualities}},{key:"addOffering",value:function(e){this.getOfferingsProperty().push(e)}},{key:"registerOffering",value:function(e){var t=this,r=this.server.getUrl()+"wa/istsos/services/"+this.getServiceJSON().service+"/offerings",i={};return this.server.getLoginConfig()&&(i.headers=this.server.getLoginConfig()),i.data=JSON.stringify(e.getOfferingJSON()),s.HttpAPI.post(r,i).then(function(e){if(e.success)return t.fireEvent("NEW_OFFERING",e),e;throw e.message},function(e){throw e})}},{key:"getOfferingNames",value:function(){var e=this,t=this.server.getUrl()+"wa/istsos/services/"+this.getServiceJSON().service+"/offerings/operations/getlist",r={};return this.server.getLoginConfig()&&(r.headers=this.server.getLoginConfig()),s.HttpAPI.get(t,r).then(function(t){if(t.success)return e.fireEvent("OFFERING_NAMES",t),t;throw t.message},function(e){throw e})}},{key:"getOfferings",value:function(){var e=this,t=this.server.getUrl()+"wa/istsos/services/"+this.getServiceJSON().service+"/offerings",r={};return this.server.getLoginConfig()&&(r.headers=this.server.getLoginConfig()),s.HttpAPI.get(t,r).then(function(t){if(t.success)return e.fireEvent("OFFERING_LIST",t),t;throw t.message},function(e){throw e})}},{key:"addProcedure",value:function(e){this.getProceduresProperty().push(e)}},{key:"registerProcedure",value:function(e){var t=this,r=this.server.getUrl()+"wa/istsos/services/"+this.getServiceJSON().service+"/procedures",i={};return this.server.getLoginConfig()&&(i.headers=this.server.getLoginConfig()),i.data=JSON.stringify(e.getProcedureJSON()),s.HttpAPI.post(r,i).then(function(e){if(e.success)return t.fireEvent("NEW_PROCEDURE",e),e;throw e.message},function(e){throw e})}},{key:"getProcedure",value:function(e){var t=this;e=this.server.getUrl()+"wa/istsos/services/"+this.getServiceJSON().service+"/procedures/"+e.getProcedureJSON().system;var r={};return this.server.getLoginConfig()&&(r.headers=this.server.getLoginConfig()),s.HttpAPI.get(e,r).then(function(e){if(e.success)return t.fireEvent("PROCEDURE",e),e;throw e.message},function(e){throw e})}},{key:"getProcedures",value:function(){var e=this,t=this.server.getUrl()+"wa/istsos/services/"+this.getServiceJSON().service+"/procedures/operations/getlist",r={};return this.server.getLoginConfig()&&(r.headers=this.server.getLoginConfig()),s.HttpAPI.get(t,r).then(function(t){if(t.success)return e.fireEvent("PROCEDURES",t),t;throw t.message},function(e){throw e})}},{key:"addVirtualProcedure",value:function(e){this.getVirtualProceduresProperty().push(e)}},{key:"registerVirtualProcedure",value:function(e){var t=this,r=this.server.getUrl()+"wa/istsos/services/"+this.getServiceJSON().service+"/procedures",i={};return this.server.getLoginConfig()&&(i.headers=this.server.getLoginConfig()),i.data=JSON.stringify(e.getVirtualProcedureJSON()),s.HttpAPI.post(r,i).then(function(e){if(e.success)return t.fireEvent("NEW_VIRTUAL_PROCEDURE",e),e;throw e.message},function(e){throw e})}},{key:"getVirtualProcedure",value:function(e){var t=this;e=this.server.getUrl()+"wa/istsos/services/"+this.getServiceJSON().service+"/virtualprocedures";var r={};return this.server.getLoginConfig()&&(r.headers=this.server.getLoginConfig()),s.HttpAPI.get(e,r).then(function(e){if(e.success)return t.fireEvent("VIRTUAL_PROCEDURE",e),e;throw e.message},function(e){throw e})}},{key:"getVirtualProcedures",value:function(){var e=this,t=this.server.getUrl()+"wa/istsos/services/"+this.getServiceJSON().service+"/virtualprocedures/operations/getlist",r={};return this.server.getLoginConfig()&&(r.headers=this.server.getLoginConfig()),s.HttpAPI.get(t,r).then(function(t){if(t.success)return e.fireEvent("VIRTUAL_PROCEDURES",t),t;throw t.message},function(e){throw e})}},{key:"addObservedProperty",value:function(e){this.getObservedPropertiesProperty().push(e)}},{key:"registerObservedProperty",value:function(e){var t=this,r=this.server.getUrl()+"wa/istsos/services/"+this.getServiceJSON().service+"/observedproperties";this.executeRequest(r,istsos.events.EventType.NEW_OBSERVED_PROPERTY,"POST",JSON.stringify(e.getObservedPropertyJSON()));var i={};return this.server.getLoginConfig()&&(i.headers=this.server.getLoginConfig()),i.data=JSON.stringify(e.getObservedPropertyJSON()),s.HttpAPI.post(r,i).then(function(e){if(e.success)return t.fireEvent("NEW_OBSERVED_PROPERTY",e),e;throw e.message},function(e){throw e})}},{key:"getObservedProperties",value:function(){var e=this,t=this.server.getUrl()+"wa/istsos/services/"+this.getServiceJSON().service+"/observedproperties",r={};return this.server.getLoginConfig()&&(r.headers=this.server.getLoginConfig()),s.HttpAPI.get(t,r).then(function(t){if(t.success)return e.fireEvent("OBSERVED_PROPERTIES",t),t;throw t.message},function(e){throw e})}},{key:"getObservedProperty",value:function(e){var t=this;e=this.server.getUrl()+"wa/istsos/services/"+this.getServiceJSON().service+"/observedproperties/"+e.getObservedPropertyJSON().definition;var r={};return this.server.getLoginConfig()&&(r.headers=this.server.getLoginConfig()),s.HttpAPI.get(e,r).then(function(e){if(e.success)return t.fireEvent("OBSERVED_PROPERTY",e),e;throw e.message},function(e){throw e})}},{key:"addUom",value:function(e){this.getUomsProperty().push(e)}},{key:"registerUom",value:function(e){var t=this;e=this.server.getUrl()+"wa/istsos/services/"+this.getServiceJSON().service+"/uoms";var r={};return this.server.getLoginConfig()&&(r.headers=this.server.getLoginConfig()),r.data=JSON.stringify(property.getUomJSON()),s.HttpAPI.post(e,r).then(function(e){if(e.success)return t.fireEvent("NEW_UOM",e),e;throw e.message},function(e){throw e})}},{key:"getUoms",value:function(){var e=this,t=this.server.getUrl()+"wa/istsos/services/"+this.getServiceJSON().service+"/uoms",r={};return this.server.getLoginConfig()&&(r.headers=this.server.getLoginConfig()),s.HttpAPI.get(t,r).then(function(t){if(t.success)return e.fireEvent("UOMS",t),t;throw t.message},function(e){throw e})}},{key:"getUom",value:function(e){var t=this;e=this.server.getUrl()+"wa/istsos/services/"+this.getServiceJSON().service+"/uoms/"+e.getUomJSON().name;var r={};return this.server.getLoginConfig()&&(r.headers=this.server.getLoginConfig()),s.HttpAPI.get(e,r).then(function(e){if(e.success)return t.fireEvent("UOM",e),e;throw e.message},function(e){throw e})}},{key:"addDataQuality",value:function(e){this.getDataQualitiesProperty().push(e)}},{key:"registerDataQuality",value:function(e){var t=this,r=this.server.getUrl()+"wa/istsos/services/"+this.getServiceJSON().service+"/dataqualities";return this.executeRequest(r,istsos.events.EventType.NEW_DATAQUALITY,"POST",JSON.stringify(e.getDataQualityJSON())),e={},this.server.getLoginConfig()&&(e.headers=this.server.getLoginConfig()),e.data=JSON.stringify(property.getDataQualityJSON()),s.HttpAPI.post(r,e).then(function(e){if(e.success)return t.fireEvent("NEW_DATAQUALITY",e),e;throw e.message},function(e){throw e})}},{key:"getDataQualities",value:function(){var e=this,t=this.server.getUrl()+"wa/istsos/services/"+this.getServiceJSON().service+"/dataqualities",r={};return this.server.getLoginConfig()&&(r.headers=this.server.getLoginConfig()),s.HttpAPI.get(t,r).then(function(t){if(t.success)return e.fireEvent("DATAQUALITIES",t),t;throw t.message},function(e){throw e})}},{key:"getDataQuality",value:function(e){var t=this;e=this.server.getUrl()+"wa/istsos/services/"+this.getServiceJSON().service+"/dataqualities/"+e.getDataQualityJSON().code;var r={};return this.server.getLoginConfig()&&(r.headers=this.server.getLoginConfig()),s.HttpAPI.get(e,r).then(function(e){if(e.success)return t.fireEvent("DATAQUALITY",e),e;throw e.message},function(e){throw e})}},{key:"getSystemTypes",value:function(){var e=this,t=this.server.getUrl()+"wa/istsos/services/"+this.getServiceJSON().service+"/systemtypes",r={};return this.server.getLoginConfig()&&(r.headers=this.server.getLoginConfig()),s.HttpAPI.get(t,r).then(function(t){if(t.success)return e.fireEvent("SYSTEM_TYPES",t),t;throw t.message},function(e){throw e})}},{key:"getDatabaseProperty",value:function(){return this.db}},{key:"getDatabase",value:function(){return this.db.getDb(this.getServiceJSON().service,this.server)}},{key:"getObservations",value:function(e){var t=this;e=(0,c.prepareForGetObservations)(e),e=this.server.getUrl()+"wa/istsos/services/"+this.name+"/operations/getobservation/offerings/"+e.offering+"/procedures/"+e.procedureNames+"/observedproperties/"+e.observedPropertyUrns+"/eventtime/"+e.begin+"/"+e.end;var r={};return this.server.getLoginConfig()&&(r.headers=this.server.getLoginConfig()),s.HttpAPI.get(e,r).then(function(e){if(e.success)return t.fireEvent("GETOBSERVATIONS",e),e;throw e.message},function(e){throw e})}},{key:"getObservationsWithAggregation",value:function(e,t){var r=this;return e=(0,c.prepareForGetObservations)(e,t,"aggregation"),e=this.server.getUrl()+"wa/istsos/services/"+this.name+"/operations/getobservation/offerings/"+e.offering+"/procedures/"+e.procedureNames+"/observedproperties/"+e.observedPropertyUrns+"/eventtime/"+e.begin+"/"+e.end+"/"+e.aggregationURL,t={},this.server.getLoginConfig()&&(t.headers=this.server.getLoginConfig()),s.HttpAPI.get(e,t).then(function(e){if(e.success)return r.fireEvent("GETOBSERVATIONS_AGG",e),e;throw e.message},function(e){throw e})}},{key:"getObservationsSimplified",value:function(e){var t=this;e=(0,c.prepareForGetObservations)(e),e=this.server.getUrl()+"wa/istsos/services/"+this.name+"/operations/getobservation/offerings/"+e.offering+"/procedures/"+e.procedureNames+"/observedproperties/"+e.observedPropertyUrns+"/eventtime/"+e.begin+"/"+e.end;var r={};return this.server.getLoginConfig()&&(r.headers=this.server.getLoginConfig()),s.HttpAPI.get(e,r).then(function(e){if(e.success)return e=(0,c.transformGetObservationsResponse)("simple",e),t.fireEvent("GETOBSERVATIONS_SIMPLIFIED",e),e;throw e.message},function(e){throw e})}},{key:"getObservationsByQualityIndexConstraint",value:function(e,t){var r=this;e=(0,c.prepareForGetObservations)(e),e=this.server.getUrl()+"wa/istsos/services/"+this.name+"/operations/getobservation/offerings/"+e.offering+"/procedures/"+e.procedureNames+"/observedproperties/"+e.observedPropertyUrns+"/eventtime/"+e.begin+"/"+e.end;var i={};return this.server.getLoginConfig()&&(i.headers=this.server.getLoginConfig()),s.HttpAPI.get(e,i).then(function(e){if(e.success){var i=(0,c.transformGetObservationsResponse)("constraint",e,t);return r.fireEvent("GETOBSERVATIONS_BY_QUALITY",i),e}throw e.message},function(e){throw e})}},{key:"getFeatureCollection",value:function(e){var t=this,r=this.server.getUrl()+"wa/istsos/services/"+this.name+"/procedures/operations/geojson";return e.opt_epsg&&(r+="?epsg="+e.opt_epsg.toString(),e.opt_offering||e.opt_procedure)&&(e.opt_offering&&(r+="&offering="+e.opt_offering.getOfferingJSON().name),e.opt_procedure&&e.opt_procedure instanceof istsos.Procedure?r+="&procedure="+e.opt_procedure.getProcedureJSON().system:e.opt_procedure&&e.opt_procedure instanceof istsos.VirtualProcedure&&(r+="&procedure="+e.opt_procedure.getVirtualProcedureJSON().system)),e={},this.server.getLoginConfig()&&(e.headers=this.server.getLoginConfig()),s.HttpAPI.get(r,e).then(function(e){if(e.success)return t.fireEvent("GEOJSON",e),e;throw e.message},function(e){throw e})}}]),t}(e.EventEmitter)},function(e,t,r){function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.UnitOfMeasure=void 0;var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,r,i){return r&&e(t.prototype,r),i&&e(t,i),t}}(),o=function e(t,r,i){null===t&&(t=Function.prototype);var n=Object.getOwnPropertyDescriptor(t,r);return void 0!==n?"value"in n?n.value:(r=n.get,void 0===r?void 0:r.call(i)):null!==(t=Object.getPrototypeOf(t))?e(t,r,i):void 0},s=r(0);e=r(1),t.UnitOfMeasure=function(e){function t(e){if(!(this instanceof t))throw new TypeError("Cannot call a class as a function");var r;if(r=(t.__proto__||Object.getPrototypeOf(t)).call(this),!this)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r=!r||"object"!=typeof r&&"function"!=typeof r?this:r,r.name=e.name,r.description=e.description||"",r.proceduresIncluded=[],r.service=e.service,e.service.addUom(r),r.updateProceduresIncluded(),r}return i(t,e),n(t,[{key:"fireEvent",value:function(e,r){o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"fire",this).call(this,e,r)}},{key:"on",value:function(e,r){o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"on",this).call(this,e,r)}},{key:"once",value:function(e,r){o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"once",this).call(this,e,r)}},{key:"off",value:function(e,r){o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"off",this).call(this,e,r)}},{key:"unlistenAll",value:function(){o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"unlistenAll",this).call(this)}},{key:"updateProceduresIncluded",value:function(){var e=this.service.getProceduresProperty(),t=this.service.getVirtualProceduresProperty(),e=e.concat(t),t=this.name;if(0!==e.length)for(var r=0;r<e.length;r++)for(var i=0;i<e[r].getOutputsProperty().length;i++)t===e[r].getOutputsProperty()[i].uom&&this.proceduresIncluded.push(e[r])}},{key:"getUomJSON",value:function(){return{name:this.name,description:this.description}}},{key:"updateUom",value:function(e){var t=this,r=this.name;return this.name=e.newName||this.name,this.description=e.newDescr||this.description,e=this.service.server.getUrl()+"wa/istsos/services/"+this.service.getServiceJSON().service+"/uoms/"+r,r={},this.service.server.getLoginConfig()&&(r.headers=this.service.server.getLoginConfig()),r.data=JSON.stringify(this.getUomJSON()),s.HttpAPI.put(e,r).then(function(e){if(e.success)return t.fireEvent("UPDATE_UOM",e),e;throw e.message},function(e){throw e})}},{key:"deleteUom",value:function(){var e=this,t=this.service.getProceduresProperty(),r=this.service.getVirtualProceduresProperty(),i=this.service.getUomsProperty(),n=[];t.concat(r).forEach(function(e){n.concat(e.getOutputsProperty())});for(var t=this.name,r=!1,o=0;o<n.length;o++)if(t===n[o].getOutputJSON().uom){alert("CONNECTED TO PROCEDURE"),r=!0;break}if(!1===r)for(t=0;t<i.length;t++)this===i[t]&&i.splice(t,1);return i=this.service.server.getUrl()+"wa/istsos/services/"+this.service.getServiceJSON().service+"/uoms/"+this.getUomJSON().name,t={},this.service.server.getLoginConfig()&&(t.headers=this.service.server.getLoginConfig()),t.data=JSON.stringify(this.getUomJSON()),s.HttpAPI.delete(i,t).then(function(t){if(t.success)return e.fireEvent("DELETE_UOM",t),t;throw t.message},function(e){throw e})}}]),t}(e.EventEmitter)},function(e,t,r){function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.VirtualProcedure=void 0;var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,r,i){return r&&e(t.prototype,r),i&&e(t,i),t}}(),o=function e(t,r,i){null===t&&(t=Function.prototype);var n=Object.getOwnPropertyDescriptor(t,r);return void 0!==n?"value"in n?n.value:(r=n.get,void 0===r?void 0:r.call(i)):null!==(t=Object.getPrototypeOf(t))?e(t,r,i):void 0};e=r(4);var s=r(0);t.VirtualProcedure=function(e){function t(e){if(!(this instanceof t))throw new TypeError("Cannot call a class as a function");var r;if(r=(t.__proto__||Object.getPrototypeOf(t)).call(this,{name:e.name,description:e.description,keywords:e.keywords,foi_name:e.foi_name,epsg:e.epsg,x:e.x,y:e.y,z:e.z,outputs:e.outputs}),!this)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r=!r||"object"!=typeof r&&"function"!=typeof r?this:r,r.systemType="virtual"===e.systemType?e.systemType:null,r.sensorType=e.sensorType||"",r.service=e.service,r.code={code:e.code},r.ratingCurve=e.ratingCurve||{},e.service.addVirtualProcedure(r),e.service.getOfferingsProperty()[0].getMemberProceduresProperty().push(r),r}return i(t,e),n(t,[{key:"fireEvent",value:function(e,r){o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"fire",this).call(this,e,r)}},{key:"on",value:function(e,r){o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"on",this).call(this,e,r)}},{key:"once",value:function(e,r){o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"once",this).call(this,e,r)}},{key:"off",value:function(e,r){o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"off",this).call(this,e,r)}},{key:"unlistenAll",value:function(){o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"unlistenAll",this).call(this)}},{key:"getVirtualProcedureJSON",value:function(){var e=o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"getProcedureBaseJSON",this).call(this);return e.classification=[{name:"System Type",definition:"urn:ogc:def:classifier:x-istsos:1.0:systemType",value:"virtual"===this.systemType?this.systemType:null},{name:"Sensor Type",definition:"urn:ogc:def:classifier:x-istsos:1.0:sensorType",value:this.sensorType}],e}},{key:"getCode",value:function(){var e=this,t=this.service.server.getUrl()+"wa/istsos/services/"+this.service.getServiceJSON().service+"/virtualprocedures/"+this.getVirtualProcedureJSON().system+"/code",r={};return this.service.server.getLoginConfig()&&(r.headers=this.service.server.getLoginConfig()),s.HttpAPI.get(t,r).then(function(t){if(t.success)return e.fireEvent("GET_CODE",t),t;throw t.message},function(e){throw e})}},{key:"registerCode",value:function(){var e=this,t=this.service.server.getUrl()+"wa/istsos/services/"+this.service.getServiceJSON().service+"/virtualprocedures/"+this.getVirtualProcedureJSON().system+"/code";this.executeRequest(t,istsos.events.EventType.NEW_CODE,"POST",JSON.stringify(this.getCodeProperty()));var r={};return this.service.server.getLoginConfig()&&(r.headers=this.service.server.getLoginConfig()),r.data=JSON.stringify(this.getCodeProperty()),s.HttpAPI.post(t,r).then(function(t){if(t.success)return e.fireEvent("NEW_CODE",t),t;throw t.message},function(e){throw e})}},{key:"updateCode",value:function(e){var t=this;this.code={code:e},e=this.service.server.getUrl()+"wa/istsos/services/"+this.service.getServiceJSON().service+"/virtualprocedures/"+this.getVirtualProcedureJSON().system+"/code";var r={};return this.service.server.getLoginConfig()&&(r.headers=this.service.server.getLoginConfig()),r.data=JSON.stringify(this.getCodeProperty()),s.HttpAPI.put(e,r).then(function(e){if(e.success)return t.fireEvent("UPDATE_CODE",e),e;throw e.message},function(e){throw e})}},{key:"deleteCode",value:function(){var e=this;this.code="";var t=this.service.server.getUrl()+"wa/istsos/services/"+this.service.getServiceJSON().service+"/virtualprocedures/"+this.getVirtualProcedureJSON().system+"/code",r={};return this.service.server.getLoginConfig()&&(r.headers=this.service.server.getLoginConfig()),s.HttpAPI.delete(t,r).then(function(t){if(t.success)return e.fireEvent("DELETE_CODE",t),t;throw t.message},function(e){throw e})}},{key:"getCodeProperty",value:function(){return this.code}},{key:"getRatingCurve",value:function(){var e=this,t=this.service.server.getUrl()+"wa/istsos/services/"+this.service.getServiceJSON().service+"/virtualprocedures/"+this.getVirtualProcedureJSON().system+"/ratingcurve",r={};return this.service.server.getLoginConfig()&&(r.headers=this.service.server.getLoginConfig()),s.HttpAPI.get(t,r).then(function(t){if(t.success)return e.fireEvent("RATING_CURVE",t),t;throw t.message},function(e){throw e})}},{key:"registerRatingCurve",value:function(){var e=this,t=this.service.server.getUrl()+"wa/istsos/services/"+this.service.getServiceJSON().service+"/virtualprocedures/"+this.getVirtualProcedureJSON().system+"/ratingcurve",r={};return this.service.server.getLoginConfig()&&(r.headers=this.service.server.getLoginConfig()),r.data=JSON.stringify(this.getRatingCurveProperty()),s.HttpAPI.post(t,r).then(function(t){if(t.success)return e.fireEvent("NEW_RATING_CURVE",t),t;throw t.message},function(e){throw e})}},{key:"deleteRatingCurve",value:function(){var e=this;this.ratingCurve={};var t=this.service.server.getUrl()+"wa/istsos/services/"+this.service.getServiceJSON().service+"/virtualprocedures/"+this.getVirtualProcedureJSON().system+"/ratingcurve",r={};return this.service.server.getLoginConfig()&&(r.headers=this.service.server.getLoginConfig()),s.HttpAPI.delete(t,r).then(function(t){if(t.success)return e.fireEvent("DELETE_RATING_CURVE",t),t;throw t.message},function(e){throw e})}},{key:"getRatingCurveProperty",value:function(){return this.ratingCurve}},{key:"updateVirtualProcedure",value:function(e){var t=this,r=this.name;this.name=e.name||this.name,this.description=e.description||this.description,this.keywords=e.keywords||this.keywords,this.foi_name=e.foi_name||this.foi_name,this.epsg=option.sepsg||this.epsg,this.coordinates=[e.x,e.y,e.z];var i=this.outputs;return(e.outputs||0!==e.outputs.length)&&(i.splice(1,i.length-1),e.outputs.forEach(function(e){i.push(e)})),this.systemType="virtual"===e.systemType?e.systemType:null,this.sensorType=e.sensorType||"",e=this.service.server.getUrl()+"wa/istsos/services/"+this.service.getServiceJSON().service+"/virtualprocedures/"+r,r={},this.service.server.getLoginConfig()&&(r.headers=this.service.server.getLoginConfig()),r.data=JSON.stringify(this.getVirtualProcedureJSON()),s.HttpAPI.put(e,r).then(function(e){if(e.success)return t.fireEvent("UPDATE_V_PROCEDURE",e),e;throw e.message},function(e){throw e})}},{key:"deleteVirtualProcedure",value:function(){var e=this,t=this.service.getVirtualProceduresProperty(),r=this.getVirtualProcedureJSON();t.forEach(function(e){e.getVirtualProcedureJSON().system===r.system&&t.splice(t.indexOf(e),1)});var i=this.service.server.getUrl()+"wa/istsos/services/"+this.service.getServiceJSON().service+"/virtualprocedures/"+this.name,n={};return this.service.server.getLoginConfig()&&(n.headers=this.service.server.getLoginConfig()),s.HttpAPI.delete(i,n).then(function(t){if(t.success)return e.fireEvent("DELETE_V_PROCEDURE",t),t;throw t.message},function(e){throw e})}},{key:"addMembershipToOffering",value:function(e){var t=this;e.getMemberProceduresProperty().push(this);var r=this.service.server.getUrl()+"wa/istsos/services/"+this.service.getServiceJSON().service+"/offerings/"+e.getOfferingJSON().name+"/procedures";e=[{offering:e.getOfferingJSON().name,procedure:this.getVirtualProcedureJSON().system}];var i={};return this.service.server.getLoginConfig()&&(i.headers=this.service.server.getLoginConfig()),i.data=JSON.stringify(e),s.HttpAPI.post(r,i).then(function(e){if(e.success)return t.fireEvent("ADD_TO_OFFERING",e),e;throw e.message},function(e){throw e})}},{key:"removeMembershipFromOffering",value:function(e){var t=this,r=e.getMemberProceduresProperty(),i=this.name;r.forEach(function(e){e.name===i&&r.splice(r.indexOf(e),1)});var n=this.service.server.getUrl()+"wa/istsos/services/"+this.service.getServiceJSON().service+"/offerings/"+e.getOfferingJSON().name+"/procedures/"+this.getVirtualProcedureJSON().system;e=[{offering:e.getOfferingJSON().name,procedure:this.getVirtualProcedureJSON().system}];var o={};return this.service.server.getLoginConfig()&&(o.headers=this.service.server.getLoginConfig()),o.data=JSON.stringify(e),s.HttpAPI.delete(n,o).then(function(e){if(e.success)return t.fireEvent("REMOVE_FROM_OFFERING",e),e;throw e.message},function(e){throw e})}},{key:"getOutputsProperty",value:function(){return o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"getOutputsProperty",this).call(this)}}]),t}(e.ProcedureBase)},function(e,t,r){t=r(14);var i=r(5),n=r(9),o=r(3),s=r(13),a=r(0),u=r(6),c=r(1),f=r(8),h=r(16),p=r(15),l=r(10),v=r(11),g=r(4),y=r(12),d=r(17),O=r(7);r=r(2),e.exports={ServerContainer:t.ServerContainer,Date:i.Date,Database:n.Database,Server:s.Server,EventEmitter:c.EventEmitter,EventTypes:u.EventTypes,Configuration:o.Configuration,HttpAPI:a.HttpAPI,DataQuality:f.DataQuality,UnitOfMeasure:h.UnitOfMeasure,IstsosHelper:{validateConstraintInput:r.validateConstraintInput,ConstraintInputs:r.ConstraintInputs,prepareForGetObservations:r.prepareForGetObservations,transformGetObservationsResponse:r.transformGetObservationsResponse},Service:p.Service,ObservedProperty:l.ObservedProperty,Output:v.Output,ProcedureBase:g.ProcedureBase,Procedure:y.Procedure,VirtualProcedure:d.VirtualProcedure,Offering:O.Offering}},function(e,t,r){function i(e){var t=e.length;if(0<t%4)throw Error("Invalid string. Length must be a multiple of 4");return"="===e[t-2]?2:"="===e[t-1]?1:0}function n(e,t,r){for(var i=[],n=t;n<r;n+=3)t=(e[n]<<16)+(e[n+1]<<8)+e[n+2],i.push(o[t>>18&63]+o[t>>12&63]+o[t>>6&63]+o[63&t]);return i.join("")}t.byteLength=function(e){return 3*e.length/4-i(e)},t.toByteArray=function(e){var t,r,n,o,u;t=e.length,o=i(e),u=new a(3*t/4-o),r=0<o?t-4:t;var c=0;for(t=0;t<r;t+=4)n=s[e.charCodeAt(t)]<<18|s[e.charCodeAt(t+1)]<<12|s[e.charCodeAt(t+2)]<<6|s[e.charCodeAt(t+3)],u[c++]=n>>16&255,u[c++]=n>>8&255,u[c++]=255&n;return 2===o?(n=s[e.charCodeAt(t)]<<2|s[e.charCodeAt(t+1)]>>4,u[c++]=255&n):1===o&&(n=s[e.charCodeAt(t)]<<10|s[e.charCodeAt(t+1)]<<4|s[e.charCodeAt(t+2)]>>2,u[c++]=n>>8&255,u[c++]=255&n),u},t.fromByteArray=function(e){for(var t=e.length,r=t%3,i="",s=[],a=0,u=t-r;a<u;a+=16383)s.push(n(e,a,a+16383>u?u:a+16383));return 1===r?(e=e[t-1],i+=o[e>>2],i+=o[e<<4&63],i+="=="):2===r&&(e=(e[t-2]<<8)+e[t-1],i+=o[e>>10],i+=o[e>>4&63],i+=o[e<<2&63],i+="="),s.push(i),s.join("")};var o=[],s=[],a="undefined"!=typeof Uint8Array?Uint8Array:Array;for(e=0;64>e;++e)o[e]="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[e],s["ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charCodeAt(e)]=e;s[45]=62,s[95]=63},function(e,t,r){(function(e){function i(e,t){if((n.TYPED_ARRAY_SUPPORT?2147483647:1073741823)<t)throw new RangeError("Invalid typed array length");return n.TYPED_ARRAY_SUPPORT?(e=new Uint8Array(t),e.__proto__=n.prototype):(null===e&&(e=new n(t)),e.length=t),e}function n(e,t,r){if(!(n.TYPED_ARRAY_SUPPORT||this instanceof n))return new n(e,t,r);if("number"==typeof e){if("string"==typeof t)throw Error("If encoding is specified then the first argument must be a string");return a(this,e)}return o(this,e,t,r)}function o(e,t,r,o){if("number"==typeof t)throw new TypeError('"value" argument must not be a number');if("undefined"!=typeof ArrayBuffer&&t instanceof ArrayBuffer){if(t.byteLength,0>r||t.byteLength<r)throw new RangeError("'offset' is out of bounds");if(t.byteLength<r+(o||0))throw new RangeError("'length' is out of bounds");return t=void 0===r&&void 0===o?new Uint8Array(t):void 0===o?new Uint8Array(t,r):new Uint8Array(t,r,o),n.TYPED_ARRAY_SUPPORT?(e=t,e.__proto__=n.prototype):e=u(e,t),e}if("string"==typeof t){if(o=e,e=r,"string"==typeof e&&""!==e||(e="utf8"),!n.isEncoding(e))throw new TypeError('"encoding" must be a valid string encoding');return r=0|h(t,e),o=i(o,r),t=o.write(t,e),t!==r&&(o=o.slice(0,t)),o}return c(e,t)}function s(e){if("number"!=typeof e)throw new TypeError('"size" argument must be a number');if(0>e)throw new RangeError('"size" argument must not be negative')}function a(e,t){if(s(t),e=i(e,0>t?0:0|f(t)),!n.TYPED_ARRAY_SUPPORT)for(var r=0;r<t;++r)e[r]=0;return e}function u(e,t){var r=0>t.length?0:0|f(t.length);e=i(e,r);for(var n=0;n<r;n+=1)e[n]=255&t[n];return e}function c(e,t){if(n.isBuffer(t)){var r=0|f(t.length);return e=i(e,r),0===e.length?e:(t.copy(e,0,0,r),e)}if(t){if("undefined"!=typeof ArrayBuffer&&t.buffer instanceof ArrayBuffer||"length"in t)return(r="number"!=typeof t.length)||(r=t.length,r=r!==r),r?i(e,0):u(e,t);if("Buffer"===t.type&&N(t.data))return u(e,t.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}function f(e){if(e>=(n.TYPED_ARRAY_SUPPORT?2147483647:1073741823))throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+(n.TYPED_ARRAY_SUPPORT?2147483647:1073741823).toString(16)+" bytes");return 0|e}function h(e,t){if(n.isBuffer(e))return e.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(e)||e instanceof ArrayBuffer))return e.byteLength;"string"!=typeof e&&(e=""+e);var r=e.length;if(0===r)return 0;for(var i=!1;;)switch(t){case"ascii":case"latin1":case"binary":return r;case"utf8":case"utf-8":case void 0:return S(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*r;case"hex":return r>>>1;case"base64":return A.toByteArray(w(e)).length;default:if(i)return S(e).length;t=(""+t).toLowerCase(),i=!0}}function p(e,t,r){var i=!1;if((void 0===t||0>t)&&(t=0),t>this.length)return"";if((void 0===r||r>this.length)&&(r=this.length),0>=r)return"";if(r>>>=0,t>>>=0,r<=t)return"";for(e||(e="utf8");;)switch(e){case"hex":for(e=t,t=r,r=this.length,(!e||0>e)&&(e=0),(!t||0>t||t>r)&&(t=r),i="",r=e;r<t;++r)e=i,i=this[r],i=16>i?"0"+i.toString(16):i.toString(16),i=e+i;return i;case"utf8":case"utf-8":return y(this,t,r);case"ascii":for(e="",r=Math.min(this.length,r);t<r;++t)e+=String.fromCharCode(127&this[t]);return e;case"latin1":case"binary":for(e="",r=Math.min(this.length,r);t<r;++t)e+=String.fromCharCode(this[t]);return e;case"base64":return t=0===t&&r===this.length?A.fromByteArray(this):A.fromByteArray(this.slice(t,r));case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":for(t=this.slice(t,r),r="",e=0;e<t.length;e+=2)r+=String.fromCharCode(t[e]+256*t[e+1]);return r;default:if(i)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),i=!0}}function l(e,t,r){var i=e[t];e[t]=e[r],e[r]=i}function v(e,t,r,i,o){if(0===e.length)return-1;if("string"==typeof r?(i=r,r=0):2147483647<r?r=2147483647:-2147483648>r&&(r=-2147483648),r=+r,isNaN(r)&&(r=o?0:e.length-1),0>r&&(r=e.length+r),r>=e.length){if(o)return-1;r=e.length-1}else if(0>r){if(!o)return-1;r=0}if("string"==typeof t&&(t=n.from(t,i)),n.isBuffer(t))return 0===t.length?-1:g(e,t,r,i,o);if("number"==typeof t)return t&=255,n.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?o?Uint8Array.prototype.indexOf.call(e,t,r):Uint8Array.prototype.lastIndexOf.call(e,t,r):g(e,[t],r,i,o);throw new TypeError("val must be string, number or Buffer")}function g(e,t,r,i,n){function o(e,t){return 1===s?e[t]:e.readUInt16BE(t*s)}var s=1,a=e.length,u=t.length;if(void 0!==i&&("ucs2"===(i=String(i).toLowerCase())||"ucs-2"===i||"utf16le"===i||"utf-16le"===i)){if(2>e.length||2>t.length)return-1;s=2,a/=2,u/=2,r/=2}if(n)for(i=-1;r<a;r++)if(o(e,r)===o(t,-1===i?0:r-i)){if(-1===i&&(i=r),r-i+1===u)return i*s}else-1!==i&&(r-=r-i),i=-1;else for(r+u>a&&(r=a-u);0<=r;r--){for(a=!0,i=0;i<u;i++)if(o(e,r+i)!==o(t,i)){a=!1;break}if(a)return r}return-1}function y(e,t,r){r=Math.min(e.length,r);for(var i=[];t<r;){var n=e[t],o=null,s=239<n?4:223<n?3:191<n?2:1;if(t+s<=r){var a,u,c;switch(s){case 1:128>n&&(o=n);break;case 2:a=e[t+1],128==(192&a)&&127<(n=(31&n)<<6|63&a)&&(o=n);break;case 3:a=e[t+1],u=e[t+2],128==(192&a)&&128==(192&u)&&2047<(n=(15&n)<<12|(63&a)<<6|63&u)&&(55296>n||57343<n)&&(o=n);break;case 4:a=e[t+1],u=e[t+2],c=e[t+3],128==(192&a)&&128==(192&u)&&128==(192&c)&&65535<(n=(15&n)<<18|(63&a)<<12|(63&u)<<6|63&c)&&1114112>n&&(o=n)}}null===o?(o=65533,s=1):65535<o&&(o-=65536,i.push(o>>>10&1023|55296),o=56320|1023&o),i.push(o),t+=s}if((e=i.length)<=I)i=String.fromCharCode.apply(String,i);else{for(r="",t=0;t<e;)r+=String.fromCharCode.apply(String,i.slice(t,t+=I));i=r}return i}function d(e,t,r){if(0!=e%1||0>e)throw new RangeError("offset is not uint");if(e+t>r)throw new RangeError("Trying to access beyond buffer length")}function O(e,t,r,i,o,s){if(!n.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>o||t<s)throw new RangeError('"value" argument is out of bounds');if(r+i>e.length)throw new RangeError("Index out of range")}function m(e,t,r,i){0>t&&(t=65535+t+1);for(var n=0,o=Math.min(e.length-r,2);n<o;++n)e[r+n]=(t&255<<8*(i?n:1-n))>>>8*(i?n:1-n)}function _(e,t,r,i){0>t&&(t=4294967295+t+1);for(var n=0,o=Math.min(e.length-r,4);n<o;++n)e[r+n]=t>>>8*(i?n:3-n)&255}function b(e,t,r,i,n,o){if(r+i>e.length)throw new RangeError("Index out of range");if(0>r)throw new RangeError("Index out of range")}function E(e,t,r,i,n){return n||b(e,t,r,4,3.4028234663852886e38,-3.4028234663852886e38),C.write(e,t,r,i,23,4),r+4}function P(e,t,r,i,n){return n||b(e,t,r,8,1.7976931348623157e308,-1.7976931348623157e308),C.write(e,t,r,i,52,8),r+8}function w(e){if(e=e.trim?e.trim():e.replace(/^\s+|\s+$/g,""),e=e.replace(D,""),2>e.length)return"";for(;0!=e.length%4;)e+="=";return e}function S(e,t){t=t||1/0;for(var r,i=e.length,n=null,o=[],s=0;s<i;++s){if(55295<(r=e.charCodeAt(s))&&57344>r){if(!n){if(56319<r){-1<(t-=3)&&o.push(239,191,189);continue}if(s+1===i){-1<(t-=3)&&o.push(239,191,189);continue}n=r;continue}if(56320>r){-1<(t-=3)&&o.push(239,191,189),n=r;continue}r=65536+(n-55296<<10|r-56320)}else n&&-1<(t-=3)&&o.push(239,191,189);if(n=null,128>r){if(0>--t)break;o.push(r)}else if(2048>r){if(0>(t-=2))break;o.push(r>>6|192,63&r|128)}else if(65536>r){if(0>(t-=3))break;o.push(r>>12|224,r>>6&63|128,63&r|128)}else{if(!(1114112>r))throw Error("Invalid code point");if(0>(t-=4))break;o.push(r>>18|240,r>>12&63|128,r>>6&63|128,63&r|128)}}return o}function T(e){for(var t=[],r=0;r<e.length;++r)t.push(255&e.charCodeAt(r));return t}function R(e,t,r,i){for(var n=0;n<i&&!(n+r>=t.length||n>=e.length);++n)t[n+r]=e[n];return n}var A=r(19),C=r(21),N=r(22);t.Buffer=n,t.SlowBuffer=function(e){return+e!=e&&(e=0),n.alloc(+e)},t.INSPECT_MAX_BYTES=50,n.TYPED_ARRAY_SUPPORT=void 0!==e.TYPED_ARRAY_SUPPORT?e.TYPED_ARRAY_SUPPORT:function(){try{var e=new Uint8Array(1);return e.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===e.foo()&&"function"==typeof e.subarray&&0===e.subarray(1,1).byteLength}catch(e){return!1}}(),t.kMaxLength=n.TYPED_ARRAY_SUPPORT?2147483647:1073741823,n.poolSize=8192,n._augment=function(e){return e.__proto__=n.prototype,e},n.from=function(e,t,r){return o(null,e,t,r)},n.TYPED_ARRAY_SUPPORT&&(n.prototype.__proto__=Uint8Array.prototype,n.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&n[Symbol.species]===n&&Object.defineProperty(n,Symbol.species,{value:null,configurable:!0})),n.alloc=function(e,t,r){return s(e),e=0>=e?i(null,e):void 0!==t?"string"==typeof r?i(null,e).fill(t,r):i(null,e).fill(t):i(null,e)},n.allocUnsafe=function(e){return a(null,e)},n.allocUnsafeSlow=function(e){return a(null,e)},n.isBuffer=function(e){return!(null==e||!e._isBuffer)},n.compare=function(e,t){if(!n.isBuffer(e)||!n.isBuffer(t))throw new TypeError("Arguments must be Buffers");if(e===t)return 0;for(var r=e.length,i=t.length,o=0,s=Math.min(r,i);o<s;++o)if(e[o]!==t[o]){r=e[o],i=t[o];break}return r<i?-1:i<r?1:0},n.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},n.concat=function(e,t){if(!N(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return n.alloc(0);var r;if(void 0===t)for(r=t=0;r<e.length;++r)t+=e[r].length;t=n.allocUnsafe(t);var i=0;for(r=0;r<e.length;++r){var o=e[r];if(!n.isBuffer(o))throw new TypeError('"list" argument must be an Array of Buffers');o.copy(t,i),i+=o.length}return t},n.byteLength=h,n.prototype._isBuffer=!0,n.prototype.swap16=function(){var e=this.length;if(0!=e%2)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)l(this,t,t+1);return this},n.prototype.swap32=function(){var e=this.length;if(0!=e%4)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)l(this,t,t+3),l(this,t+1,t+2);return this},n.prototype.swap64=function(){var e=this.length;if(0!=e%8)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)l(this,t,t+7),l(this,t+1,t+6),l(this,t+2,t+5),l(this,t+3,t+4);return this},n.prototype.toString=function(){var e=0|this.length;return 0===e?"":0===arguments.length?y(this,0,e):p.apply(this,arguments)},n.prototype.equals=function(e){if(!n.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===n.compare(this,e)},n.prototype.inspect=function(){var e="",r=t.INSPECT_MAX_BYTES;return 0<this.length&&(e=this.toString("hex",0,r).match(/.{2}/g).join(" "),this.length>r&&(e+=" ... ")),"<Buffer "+e+">"},n.prototype.compare=function(e,t,r,i,o){if(!n.isBuffer(e))throw new TypeError("Argument must be a Buffer");if(void 0===t&&(t=0),void 0===r&&(r=e?e.length:0),void 0===i&&(i=0),void 0===o&&(o=this.length),0>t||r>e.length||0>i||o>this.length)throw new RangeError("out of range index");if(i>=o&&t>=r)return 0;if(i>=o)return-1;if(t>=r)return 1;if(t>>>=0,r>>>=0,i>>>=0,o>>>=0,this===e)return 0;var s=o-i,a=r-t,u=Math.min(s,a);for(i=this.slice(i,o),e=e.slice(t,r),t=0;t<u;++t)if(i[t]!==e[t]){s=i[t],a=e[t];break}return s<a?-1:a<s?1:0},n.prototype.includes=function(e,t,r){return-1!==this.indexOf(e,t,r)},n.prototype.indexOf=function(e,t,r){return v(this,e,t,r,!0)},n.prototype.lastIndexOf=function(e,t,r){return v(this,e,t,r,!1)},n.prototype.write=function(e,t,r,i){if(void 0===t)i="utf8",r=this.length,t=0;else if(void 0===r&&"string"==typeof t)i=t,r=this.length,t=0;else{if(!isFinite(t))throw Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t|=0,isFinite(r)?(r|=0,void 0===i&&(i="utf8")):(i=r,r=void 0)}var n=this.length-t;if((void 0===r||r>n)&&(r=n),0<e.length&&(0>r||0>t)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");for(i||(i="utf8"),n=!1;;)switch(i){case"hex":e:{if(t=Number(t)||0,i=this.length-t,r?(r=Number(r))>i&&(r=i):r=i,0!=(i=e.length)%2)throw new TypeError("Invalid hex string");for(r>i/2&&(r=i/2),i=0;i<r;++i){if(n=parseInt(e.substr(2*i,2),16),isNaN(n)){e=i;break e}this[t+i]=n}e=i}return e;case"utf8":case"utf-8":return R(S(e,this.length-t),this,t,r);case"ascii":return R(T(e),this,t,r);case"latin1":case"binary":return R(T(e),this,t,r);case"base64":return R(A.toByteArray(w(e)),this,t,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":var o;i=e;for(var n=this.length-t,s=[],a=0;a<i.length&&!(0>(n-=2));++a)o=i.charCodeAt(a),e=o>>8,o%=256,s.push(o),s.push(e);return R(s,this,t,r);default:if(n)throw new TypeError("Unknown encoding: "+i);i=(""+i).toLowerCase(),n=!0}},n.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var I=4096;n.prototype.slice=function(e,t){var r=this.length;if(e=~~e,t=void 0===t?r:~~t,0>e?0>(e+=r)&&(e=0):e>r&&(e=r),0>t?0>(t+=r)&&(t=0):t>r&&(t=r),t<e&&(t=e),n.TYPED_ARRAY_SUPPORT)t=this.subarray(e,t),t.__proto__=n.prototype;else{r=t-e,t=new n(r,void 0);for(var i=0;i<r;++i)t[i]=this[i+e]}return t},n.prototype.readUIntLE=function(e,t,r){e|=0,t|=0,r||d(e,t,this.length),r=this[e];for(var i=1,n=0;++n<t&&(i*=256);)r+=this[e+n]*i;return r},n.prototype.readUIntBE=function(e,t,r){e|=0,t|=0,r||d(e,t,this.length),r=this[e+--t];for(var i=1;0<t&&(i*=256);)r+=this[e+--t]*i;return r},n.prototype.readUInt8=function(e,t){return t||d(e,1,this.length),this[e]},n.prototype.readUInt16LE=function(e,t){return t||d(e,2,this.length),this[e]|this[e+1]<<8},n.prototype.readUInt16BE=function(e,t){return t||d(e,2,this.length),this[e]<<8|this[e+1]},n.prototype.readUInt32LE=function(e,t){return t||d(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},n.prototype.readUInt32BE=function(e,t){return t||d(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},n.prototype.readIntLE=function(e,t,r){e|=0,t|=0,r||d(e,t,this.length),r=this[e];for(var i=1,n=0;++n<t&&(i*=256);)r+=this[e+n]*i;return r>=128*i&&(r-=Math.pow(2,8*t)),r},n.prototype.readIntBE=function(e,t,r){e|=0,t|=0,r||d(e,t,this.length),r=t;for(var i=1,n=this[e+--r];0<r&&(i*=256);)n+=this[e+--r]*i;return n>=128*i&&(n-=Math.pow(2,8*t)),n},n.prototype.readInt8=function(e,t){return t||d(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},n.prototype.readInt16LE=function(e,t){return t||d(e,2,this.length),e=this[e]|this[e+1]<<8,32768&e?4294901760|e:e},n.prototype.readInt16BE=function(e,t){return t||d(e,2,this.length),e=this[e+1]|this[e]<<8,32768&e?4294901760|e:e},n.prototype.readInt32LE=function(e,t){return t||d(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},n.prototype.readInt32BE=function(e,t){return t||d(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},n.prototype.readFloatLE=function(e,t){return t||d(e,4,this.length),C.read(this,e,!0,23,4)},n.prototype.readFloatBE=function(e,t){return t||d(e,4,this.length),C.read(this,e,!1,23,4)},n.prototype.readDoubleLE=function(e,t){return t||d(e,8,this.length),C.read(this,e,!0,52,8)},n.prototype.readDoubleBE=function(e,t){return t||d(e,8,this.length),C.read(this,e,!1,52,8)},n.prototype.writeUIntLE=function(e,t,r,i){e=+e,t|=0,r|=0,i||O(this,e,t,r,Math.pow(2,8*r)-1,0),i=1;var n=0;for(this[t]=255&e;++n<r&&(i*=256);)this[t+n]=e/i&255;return t+r},n.prototype.writeUIntBE=function(e,t,r,i){e=+e,t|=0,r|=0,i||O(this,e,t,r,Math.pow(2,8*r)-1,0),i=r-1;var n=1;for(this[t+i]=255&e;0<=--i&&(n*=256);)this[t+i]=e/n&255;return t+r},n.prototype.writeUInt8=function(e,t,r){return e=+e,t|=0,r||O(this,e,t,1,255,0),n.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),this[t]=255&e,t+1},n.prototype.writeUInt16LE=function(e,t,r){return e=+e,t|=0,r||O(this,e,t,2,65535,0),n.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):m(this,e,t,!0),t+2},n.prototype.writeUInt16BE=function(e,t,r){return e=+e,t|=0,r||O(this,e,t,2,65535,0),n.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):m(this,e,t,!1),t+2},n.prototype.writeUInt32LE=function(e,t,r){return e=+e,t|=0,r||O(this,e,t,4,4294967295,0),n.TYPED_ARRAY_SUPPORT?(this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e):_(this,e,t,!0),t+4},n.prototype.writeUInt32BE=function(e,t,r){return e=+e,t|=0,r||O(this,e,t,4,4294967295,0),n.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):_(this,e,t,!1),t+4},n.prototype.writeIntLE=function(e,t,r,i){e=+e,t|=0,i||(i=Math.pow(2,8*r-1),O(this,e,t,r,i-1,-i)),i=0;var n=1,o=0;for(this[t]=255&e;++i<r&&(n*=256);)0>e&&0===o&&0!==this[t+i-1]&&(o=1),this[t+i]=(e/n>>0)-o&255;return t+r},n.prototype.writeIntBE=function(e,t,r,i){e=+e,t|=0,i||(i=Math.pow(2,8*r-1),O(this,e,t,r,i-1,-i)),i=r-1;var n=1,o=0;for(this[t+i]=255&e;0<=--i&&(n*=256);)0>e&&0===o&&0!==this[t+i+1]&&(o=1),this[t+i]=(e/n>>0)-o&255;return t+r},n.prototype.writeInt8=function(e,t,r){return e=+e,t|=0,r||O(this,e,t,1,127,-128),n.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),0>e&&(e=255+e+1),this[t]=255&e,t+1},n.prototype.writeInt16LE=function(e,t,r){return e=+e,t|=0,r||O(this,e,t,2,32767,-32768),n.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):m(this,e,t,!0),t+2},n.prototype.writeInt16BE=function(e,t,r){return e=+e,t|=0,r||O(this,e,t,2,32767,-32768),n.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):m(this,e,t,!1),t+2},n.prototype.writeInt32LE=function(e,t,r){return e=+e,t|=0,r||O(this,e,t,4,2147483647,-2147483648),n.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24):_(this,e,t,!0),t+4},n.prototype.writeInt32BE=function(e,t,r){return e=+e,t|=0,r||O(this,e,t,4,2147483647,-2147483648),0>e&&(e=4294967295+e+1),n.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):_(this,e,t,!1),t+4},n.prototype.writeFloatLE=function(e,t,r){return E(this,e,t,!0,r)},n.prototype.writeFloatBE=function(e,t,r){return E(this,e,t,!1,r)},n.prototype.writeDoubleLE=function(e,t,r){return P(this,e,t,!0,r)},n.prototype.writeDoubleBE=function(e,t,r){return P(this,e,t,!1,r)},n.prototype.copy=function(e,t,r,i){if(r||(r=0),i||0===i||(i=this.length),t>=e.length&&(t=e.length),t||(t=0),0<i&&i<r&&(i=r),i===r||0===e.length||0===this.length)return 0;if(0>t)throw new RangeError("targetStart out of bounds");if(0>r||r>=this.length)throw new RangeError("sourceStart out of bounds");if(0>i)throw new RangeError("sourceEnd out of bounds");i>this.length&&(i=this.length),e.length-t<i-r&&(i=e.length-t+r);var o=i-r;if(this===e&&r<t&&t<i)for(i=o-1;0<=i;--i)e[i+t]=this[i+r];else if(1e3>o||!n.TYPED_ARRAY_SUPPORT)for(i=0;i<o;++i)e[i+t]=this[i+r];else Uint8Array.prototype.set.call(e,this.subarray(r,r+o),t);return o},n.prototype.fill=function(e,t,r,i){if("string"==typeof e){if("string"==typeof t?(i=t,t=0,r=this.length):"string"==typeof r&&(i=r,r=this.length),1===e.length){var o=e.charCodeAt(0);256>o&&(e=o)}if(void 0!==i&&"string"!=typeof i)throw new TypeError("encoding must be a string");if("string"==typeof i&&!n.isEncoding(i))throw new TypeError("Unknown encoding: "+i)}else"number"==typeof e&&(e&=255);if(0>t||this.length<t||this.length<r)throw new RangeError("Out of range index");if(r<=t)return this;if(t>>>=0,r=void 0===r?this.length:r>>>0,e||(e=0),"number"==typeof e)for(i=t;i<r;++i)this[i]=e;else for(e=n.isBuffer(e)?e:S(new n(e,i).toString()),o=e.length,i=0;i<r-t;++i)this[i+t]=e[i%o];return this};var D=/[^+\/0-9A-Za-z-_]/g}).call(t,r(23))},function(e,t){t.read=function(e,t,r,i,n){var o;o=8*n-i-1;var s=(1<<o)-1,a=s>>1,u=-7;n=r?n-1:0;var c=r?-1:1,f=e[t+n];for(n+=c,r=f&(1<<-u)-1,f>>=-u,u+=o;0<u;r=256*r+e[t+n],n+=c,u-=8);for(o=r&(1<<-u)-1,r>>=-u,u+=i;0<u;o=256*o+e[t+n],n+=c,u-=8);if(0===r)r=1-a;else{if(r===s)return o?NaN:1/0*(f?-1:1);o+=Math.pow(2,i),r-=a}return(f?-1:1)*o*Math.pow(2,r-i)},t.write=function(e,t,r,i,n,o){var s,a=8*o-n-1,u=(1<<a)-1,c=u>>1,f=23===n?Math.pow(2,-24)-Math.pow(2,-77):0;o=i?0:o-1;var h=i?1:-1,p=0>t||0===t&&0>1/t?1:0;for(t=Math.abs(t),isNaN(t)||1/0===t?(t=isNaN(t)?1:0,i=u):(i=Math.floor(Math.log(t)/Math.LN2),1>t*(s=Math.pow(2,-i))&&(i--,s*=2),t=1<=i+c?t+f/s:t+f*Math.pow(2,1-c),2<=t*s&&(i++,s/=2),i+c>=u?(t=0,i=u):1<=i+c?(t=(t*s-1)*Math.pow(2,n),i+=c):(t=t*Math.pow(2,c-1)*Math.pow(2,n),i=0));8<=n;e[r+o]=255&t,o+=h,t/=256,n-=8);for(i=i<<n|t,a+=n;0<a;e[r+o]=255&i,o+=h,i/=256,a-=8);e[r+o-h]|=128*p}},function(e,t){var r={}.toString;e.exports=Array.isArray||function(e){return"[object Array]"==r.call(e)}},function(e,t){t=function(){return this}();try{t=t||Function("return this")()||(0,eval)("this")}catch(e){"object"==typeof window&&(t=window)}e.exports=t}])});